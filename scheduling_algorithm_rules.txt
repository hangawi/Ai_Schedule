# 📌 최신 자동 배정 알고리즘 규칙 (업데이트 완료 버전)

## 1. 개요 (Overview)
현재 스케줄링 시스템은 단일 핵심 단계인 **2단계 하이브리드 배정 알고리즘**으로 구성된다.
목표는 **멤버 전체가 최대한 많이 배정되도록 하는 것**이다.

이 문서에는 다음 변경 사항이 반영되어 있다:

- 지난 주 미배정 시간 삭제
- 이월(Carry-over) 시스템 완전 삭제
- 우선순위(Priority) 기능 활성화
- 가능한 한 모든 멤버가 배치되도록 로직 강화

---

## 2. 입력 데이터 (Input Data)

- **멤버 개인 가능 시간표**
- **주당 필요 배정 시간(예: 3시간)**
- **방장 시간표(Master Schedule 범위 제공)**
- **우선순위(priority)**  
  - 숫자가 높을수록 먼저 배정됨  
  - 필수 반영됨

---

## 3. 전체 실행 흐름 (Execution Flow)

1. **타임테이블 생성**
   - 방장의 가능한 시간을 기반으로 전체 스케줄 틀 생성
   - 각 멤버의 가능한 시간을 이 틀에 매핑

2. **우선순위 정렬**
   - 멤버들은 다음 기준으로 정렬됨:
     1) priority(높을수록 먼저)  
     2) 가능한 시간 수(적은 사람 먼저)  
     3) ID 또는 이름순  

3. **핵심 배정 실행**  
   - 아래 규칙 1(2단계 하이브리드 배정) 수행

4. **보충 단계 없음**
   - 지난 주 미배정 삭제  
   - 이월 없음  
   - 보충 알고리즘 단계 삭제됨  

---

## 4. 규칙 1: 2단계 하이브리드 배정 (`assignByTimeOrder`)

### ▸ 1단계: 완전 배정(Full Assignment) 우선 탐색
- 스케줄을 **가장 빠른 시간부터 순서대로** 훑는다.
- 특정 연속 구간에서 멤버의 전체 필요 시간을 *한 번에* 넣을 수 있으면 즉시 배정.
- 가능 멤버 다수일 경우 **우선순위(priority)** 높은 멤버가 우선 배정됨.
- 완전 배정이 안 되면 억지로 넣지 않고 다음 시간대로 넘어감.  
  → 일정이 잘게 쪼개지는 문제 방지.

### ▸ 2단계: 부분 배정(Partial Assignment) 정리
- 1단계가 끝난 후에도 배정되지 않은 멤버가 있으면 수행.
- 스케줄 전체를 다시 훑으며, 멤버가 들어갈 수 있는 가장 긴 ‘부분 배정 블록’을 찾아 배정.
- 여기서도 동일하게 **priority 높은 멤버가 우선**.
- 불가피할 때만 일정이 조각나는 것을 허용.

---

## 5. 규칙 2: 미배정/이월 시스템 삭제
- 예전의 ‘지난 주 미배정 시간(Carry-over)’ 시스템은 완전 삭제됨.
- 이전 주의 부족 시간을 다음 주로 가져오지 않음.
- 보충 알고리즘 단계도 제거됨.

---

## 6. 역할 정의

### 방장 (Owner)
- 배정 대상 X  
- 가능한 시간으로 전체 시간표의 경계를 제공함.

### 조원 (Member)
- 실제 배정 대상.

### 우선순위(Priority)
- **현재 활성화되어 있음**
- 모든 배정에서 결정적인 역할을 함:
  1) 배정 순서  
  2) 완전 배정 시 경쟁 멤버 우선 선정  
  3) 부분 배정 블록 선택 시 우선 결정

---

# ✔ 요약
- 우선순위가 핵심 기준으로 활성화됨.
- 이월 없음 / 지난 주 미배정 없음.
- 2단계 하이브리드 배정이 전부를 담당.
- 완전 배정 → 부분 배정 순서로 최대한 모두 배정되도록 구성.

# 🎯 스마트 질문 시스템

## 개선 사항

**이전**: 항상 9개 질문 (너무 많음)
**현재**: 상황에 따라 1~4개 질문만 (필요한 것만)

## 질문 로직

### 1️⃣ 충돌이 없는 경우
```
질문 개수: 0개
→ AI 최적화 불필요 (바로 스케줄 확정)
```

### 2️⃣ 충돌이 2개 과목만 겹치는 경우 (간단)
```
질문 1: "영어"와(과) "수학" 중 어떤 것이 더 중요한가요?
질문 2: 쉬고 싶은 요일이 있나요? (선택사항)

총 2개 질문
```

**예시**:
```
User: 영어
Bot: 알겠습니다! 영어를 우선으로 스케줄을 조정하겠습니다.
```

### 3️⃣ 충돌이 복잡한 경우 (3개 이상 과목)
```
질문 1: 겹치는 과목들의 우선순위를 알려주세요
         (겹치는 과목: 영어, 수학, 태권도, 피아노)
질문 2: [조건부] 저녁 시간대 충돌 있으면 → 잠자는 시간
질문 3: [조건부] 같은 날 여러 충돌 있으면 → 학원 간 이동 시간
질문 4: 쉬고 싶은 요일이 있나요? (선택사항)

총 2~4개 질문
```

**예시**:
```
User: 영어 > 수학 > 태권도
Bot: 다음 질문...
```

## 조건부 질문

### 저녁 시간대 충돌 감지
```javascript
// 18시 이후 충돌이 있을 때만 취침 시간 질문
if (충돌 중 하나라도 18:00 이후) {
  질문: "잠자는 시간은 몇 시인가요?"
}
```

### 같은 날 여러 충돌
```javascript
// 하루에 2개 이상 충돌이 있을 때만 이동 시간 질문
if (같은 요일에 충돌 2개 이상) {
  질문: "학원 간 이동 시간은 평균 몇 분인가요?"
}
```

## 질문 타입 변경

### 이전 (복잡함)
- ❌ multiselect (체크박스 여러 개)
- ❌ ranking (순서 지정)
- ❌ timerange (시작~끝 시간)
- ❌ select (드롭다운)

### 현재 (간단함)
- ✅ text (자유 텍스트 입력)
  - "영어"
  - "영어 > 수학 > 태권도"
  - "밤 10시"
  - "15분"
  - "수요일"

## 실제 예시

### 케이스 1: 간단한 충돌 (2개 과목)
```
Bot: ✨ AI 스케줄 최적화를 시작합니다!
     현재 1건의 일정 충돌이 발견되었습니다.

Bot: 📝 질문 1/2
     "영어학원"와(과) "태권도" 중 어떤 것이 더 중요한가요?

User: 영어학원

Bot: 📝 질문 2/2
     쉬고 싶은 요일이 있나요? (선택사항)

User: 없음

Bot: 🤖 AI가 최적의 스케줄을 생성하고 있습니다...

Bot: ✨ AI 최적화 완료!
     태권도와 영어학원이 화요일 4시에 겹쳐서 태권도를 제거했습니다.
     영어학원을 우선으로 유지했습니다.
```

### 케이스 2: 복잡한 충돌 (5개 과목, 저녁 시간대 포함)
```
Bot: ✨ AI 스케줄 최적화를 시작합니다!
     현재 8건의 일정 충돌이 발견되었습니다.

Bot: 📝 질문 1/4
     겹치는 과목들의 우선순위를 알려주세요
     겹치는 과목: 영어, 수학, 태권도, 피아노, 미술

User: 영어 > 수학 > 태권도 > 피아노 > 미술

Bot: 📝 질문 2/4
     잠자는 시간은 몇 시인가요?

User: 밤 10시

Bot: 📝 질문 3/4
     학원 간 이동 시간은 평균 몇 분인가요?

User: 20분

Bot: 📝 질문 4/4
     쉬고 싶은 요일이 있나요? (선택사항)

User: 수요일

Bot: 🤖 AI가 최적의 스케줄을 생성하고 있습니다...

Bot: ✨ AI 최적화 완료!
     ...
```

### 케이스 3: 충돌 없음
```
Bot: ✨ 충돌이 없습니다!
     모든 일정이 겹치지 않아 최적화가 필요하지 않습니다.

→ AI 질문 없이 바로 스케줄 확정
```

## 장점

1. **빠른 응답** ⚡
   - 9개 → 2~4개 질문 (50% 이상 단축)

2. **사용자 친화적** 😊
   - 자유 텍스트 입력
   - 복잡한 UI 제거

3. **상황 맞춤형** 🎯
   - 필요한 질문만 표시
   - 불필요한 질문 제거

4. **자연스러운 대화** 💬
   - "영어", "밤 10시", "15분" 등 자연어
   - 채팅 형식에 최적화

## 코드 변경 사항

### scheduleOptimizer.js
```javascript
export const generateOptimizationQuestions = (schedules, conflicts) => {
  // 충돌 없음 → 질문 0개
  if (conflicts.length === 0) return [];

  // 간단한 충돌 (2개) → 질문 1개
  if (conflictingSubjects.size === 2) {
    return [우선순위 질문, 휴식일 질문];
  }

  // 복잡한 충돌 → 조건부 질문 2~4개
  return [
    우선순위 질문,
    저녁충돌 ? 취침시간 : null,
    여러충돌 ? 이동시간 : null,
    휴식일 질문
  ].filter(Boolean);
};
```

## 테스트

1. **간단한 충돌 테스트**
   - 2개 과목만 겹치는 시간표 업로드
   - 질문 2개만 나오는지 확인

2. **복잡한 충돌 테스트**
   - 여러 과목이 겹치는 시간표 업로드
   - 저녁 시간대 포함 여부에 따라 질문 개수 확인

3. **충돌 없음 테스트**
   - 겹치지 않는 시간표 업로드
   - 질문 없이 바로 확정되는지 확인

## 완료! ✅

이제 AI 최적화가 훨씬 빠르고 간편해졌습니다! 🎉

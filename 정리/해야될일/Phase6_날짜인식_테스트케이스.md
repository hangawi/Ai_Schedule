# Phase 6: 날짜 인식 테스트 케이스

**작성일**: 2026-01-27
**목적**: AI 일정 제안 시스템의 날짜 인식 정확도 검증

---

## 📋 테스트 시나리오

### 1. 기본 상대 날짜 표현

#### 테스트 1.1: 내일
**대화**:
```
User A: 내일 오후 2시에 회의할까?
User B: 좋아요
User C: ㅇㅋ
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**:
```json
{
  "agreed": true,
  "date": "2026-01-28",
  "startTime": "14:00",
  "endTime": "15:00"
}
```

#### 테스트 1.2: 모레
**대화**:
```
User A: 모레 오전 10시 괜찮으세요?
User B: 네 괜찮아요
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**:
```json
{
  "agreed": true,
  "date": "2026-01-29",
  "startTime": "10:00",
  "endTime": "11:00"
}
```

---

### 2. "다음주" 표현 (가장 중요!)

#### 테스트 2.1: 다음주 월요일
**대화**:
```
User A: 다음주 월요일 오전 9시에 회의 어때?
User B: ㄱㄱ
User C: 좋아요
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `2026-02-03` (다음주 월요일)
❌ **오답 예시**: `2026-01-27` (오늘)
❌ **오답 예시**: `2026-02-02` (이번주 월요일, 이미 지남)

#### 테스트 2.2: 다음주 목요일
**대화**:
```
User A: 다음주 목요일 오후 4시에 만나자
User B: 4시 ㄱㄱ
User C: ㅇㅋ
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `2026-02-05` (다음주 목요일)
❌ **오답 예시**: `2026-01-27` (오늘)
❌ **오답 예시**: `2026-01-29` (이번주 목요일)

#### 테스트 2.3: 다음주 토요일
**대화**:
```
User A: 다음주 토요일 오후 2시에 밥약속 어떰?
User B: 좋아요
User C: ㅇㅋ
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `2026-02-07` (다음주 토요일)
❌ **오답 예시**: `2026-01-27` (오늘)
❌ **오답 예시**: `2026-01-31` (이번주 토요일)

#### 테스트 2.4: 다음주 일요일
**대화**:
```
User A: 다음주 일요일 점심 어때?
User B: ㅇㅋ
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `2026-02-08` (다음주 일요일)
❌ **오답 예시**: `2026-02-01` (이번주 일요일)

---

### 3. "이번주" 표현

#### 테스트 3.1: 이번주 금요일
**대화**:
```
User A: 이번주 금요일 저녁 6시 어때?
User B: 좋아요
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `2026-01-30` (이번주 금요일)
❌ **오답 예시**: `2026-02-06` (다음주 금요일)

#### 테스트 3.2: 이번주 월요일 (이미 지난 경우)
**대화**:
```
User A: 이번주 월요일 어때?
User B: 좋아요
```

**기준일**: 2026-01-27 (화요일)
**기대 결과**: `agreed: false` (이미 지난 날짜이므로 합의 불가능) 또는 다음주 월요일로 해석

---

### 4. 주말 경계 케이스

#### 테스트 4.1: 금요일에 "다음주 월요일"
**대화**:
```
User A: 다음주 월요일 오전 10시 회의
User B: ㅇㅋ
```

**기준일**: 2026-01-30 (금요일)
**기대 결과**: `2026-02-02` (다음주 월요일)
❌ **오답 예시**: `2026-01-26` (지난주 월요일)

#### 테스트 4.2: 토요일에 "다음주 화요일"
**대화**:
```
User A: 다음주 화요일 점심
User B: ㄱㄱ
```

**기준일**: 2026-01-31 (토요일)
**기대 결과**: `2026-02-03` (다음주 화요일)

#### 테스트 4.3: 일요일에 "다음주 수요일"
**대화**:
```
User A: 다음주 수요일 오후 3시
User B: 좋아요
```

**기준일**: 2026-02-01 (일요일)
**기대 결과**: `2026-02-04` (다음주 수요일)

---

### 5. 월말/월초 경계 케이스

#### 테스트 5.1: 1월 마지막 주에 "다음주 화요일"
**대화**:
```
User A: 다음주 화요일 회의
User B: ㅇㅋ
```

**기준일**: 2026-01-28 (수요일, 1월 마지막 주)
**기대 결과**: `2026-02-03` (2월 첫째 주 화요일)

#### 테스트 5.2: 12월 마지막 주에 "다음주 월요일"
**대화**:
```
User A: 다음주 월요일 회의
User B: 좋아요
```

**기준일**: 2025-12-29 (월요일, 12월 마지막 주)
**기대 결과**: `2026-01-05` (새해 첫째 주 월요일)

---

### 6. 구체적 날짜 표현

#### 테스트 6.1: 월/일 형식
**대화**:
```
User A: 2월 5일 오후 2시 어때?
User B: ㅇㅋ
```

**기준일**: 2026-01-27
**기대 결과**: `2026-02-05`

#### 테스트 6.2: 일만 언급 (같은 달)
**대화**:
```
User A: 30일 오전 10시에 만날까?
User B: 좋아요
```

**기준일**: 2026-01-27
**기대 결과**: `2026-01-30`

#### 테스트 6.3: 일만 언급 (다음 달)
**대화**:
```
User A: 5일 오후 3시에 회의
User B: ㅇㅋ
```

**기준일**: 2026-01-29
**기대 결과**: `2026-02-05` (1월 5일은 이미 지났으므로 2월 5일로 해석)

---

### 7. 시간 표현

#### 테스트 7.1: 오전/오후
**대화**:
```
User A: 다음주 화요일 오후 2시
User B: ㅇㅋ
```

**기준일**: 2026-01-27
**기대 결과**: `startTime: "14:00"`

#### 테스트 7.2: 24시간 형식
**대화**:
```
User A: 내일 14시에 회의
User B: 좋아요
```

**기준일**: 2026-01-27
**기대 결과**: `startTime: "14:00"`

#### 테스트 7.3: 시작/종료 시간 명시
**대화**:
```
User A: 다음주 수요일 10시부터 12시까지 회의
User B: ㄱㄱ
```

**기준일**: 2026-01-27
**기대 결과**:
```json
{
  "date": "2026-02-04",
  "startTime": "10:00",
  "endTime": "12:00"
}
```

#### 테스트 7.4: 반 (30분)
**대화**:
```
User A: 내일 2시 반에 만나자
User B: ㅇㅋ
```

**기준일**: 2026-01-27
**기대 결과**: `startTime: "14:30"`

---

### 8. 부정적 응답 (agreed: false 테스트)

#### 테스트 8.1: 거절
**대화**:
```
User A: 다음주 월요일 회의 어때?
User B: 나는 힘들 것 같아
```

**기대 결과**: `agreed: false`

#### 테스트 8.2: 여전히 논의 중
**대화**:
```
User A: 다음주 화요일 어때?
User B: 글쎄 모르겠는데
User C: 나도 확실하지 않아
```

**기대 결과**: `agreed: false`

---

## 🧪 테스트 실행 방법

### 수동 테스트
1. 서버 실행: `npm start` (server 디렉토리)
2. 클라이언트 실행: `npm start` (client 디렉토리)
3. 대화형 모드 방 생성
4. 위 테스트 케이스의 대화를 입력
5. AI 제안 결과 확인

### 자동화 테스트 (향후 구현)
```javascript
// test/aiScheduleService.test.js
describe('날짜 인식 정확도 테스트', () => {
  it('다음주 월요일을 정확히 인식해야 함', async () => {
    const result = await analyzeConversation(
      roomId,
      conversationText,
      new Date('2026-01-27') // 기준일
    );
    expect(result.date).toBe('2026-02-03');
  });
});
```

---

## ✅ 테스트 통과 기준

- **필수**: 테스트 2.1 ~ 2.4 (다음주 표현) 모두 통과
- **권장**: 테스트 1, 3, 4 통과
- **선택**: 테스트 5, 6, 7, 8 통과

---

## 📝 테스트 결과 기록

### 2026-01-10 테스트
- ❌ 테스트 2.3 실패: "다음주 토요일"을 오늘 날짜로 인식
- ✅ 수정 완료: 프롬프트에 명확한 설명 추가 (Example 5)
- ⏳ 재테스트 필요

### 2026-01-27 테스트 (예정)
- [ ] 테스트 2.1: 다음주 월요일
- [ ] 테스트 2.2: 다음주 목요일
- [ ] 테스트 2.3: 다음주 토요일
- [ ] 테스트 2.4: 다음주 일요일

---

## 🔧 프롬프트 개선 이력

### v1.0 (2026-01-10)
- 하드코딩된 규칙 제거
- LLM 중심 프롬프트로 전환
- Few-shot 예제 4개 추가

### v1.1 (2026-01-10)
- "다음주" 명확한 설명 추가
- Example 5 추가 (다음주 토요일)
- 주석 강화

### v1.2 (2026-01-27) - 예정
- 주의 경계 계산 명시
- 엣지 케이스 예제 추가

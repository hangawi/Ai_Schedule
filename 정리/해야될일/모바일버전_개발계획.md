# 모바일 버전 개발 계획

## 📅 작성일: 2026-01-05
## 🔄 최종 업데이트: 2026-01-05

---

## 🎯 목표
모바일 환경에서 대시보드 중심의 UI/UX 제공

---

## ✅ 완료된 작업

### Phase 1: 기본 구조 설정 (완료)
- ✅ `MobileDashboard.js` 컴포넌트 생성
- ✅ 모바일 감지 로직 통합 (useMobileDetection 활용)
- ✅ App.js에서 모바일일 때 대시보드 표시
- ✅ 상단 헤더 구현 (햄버거 메뉴, 로고, 로그아웃)
- ✅ 중앙 메뉴 버튼 3개 구현 (일정/그룹/달력)
- ✅ 하단 네비게이션 바 구현 (새로고침/카메라/채팅/마이크)

### Phase 2: FullCalendar 통합 (완료)
- ✅ FullCalendar 설치 완료
- ✅ `MobileScheduleView.js` 생성 및 FullCalendar 통합
- ✅ 한국어 설정 완료
- ✅ 날짜 클릭 시 일 뷰 자동 전환
- ✅ 기존 일정 API 연동 (선호시간/개인시간/예외일정)
- ✅ 타임존 문제 해결 (UTC → Local Time)
- ✅ 이벤트 병합 로직 구현 (mergeSlots)

### Phase 3: 화면 연결 (완료)
- ✅ 일정 버튼 → MobileScheduleView 연결
- ✅ 그룹 버튼 → MobileGroupsView 연결
- ✅ 달력 버튼 → MobileCalendarView 연결
- ✅ React Router 설정 완료
- ✅ SimplifiedScheduleDisplay 컴포넌트 생성 (깔끔한 디자인)

---

## 🐛 새로 발견된 문제들 (2026-01-05 - 2차)

### ✅ 완료된 문제들
1. **개인시간 빨간색 표시 누락** ✅ 완료
   - 증상: PC 버전에서는 빨간색으로 표시되던 개인시간이 모바일에서 안 보임
   - 원인: SimplifiedScheduleDisplay에서 색상 블록 표시 미구현
   - 해결: SimplifiedScheduleDisplay를 블록 UI로 변경
   - 파일: `SimplifiedScheduleDisplay.js`, `SimplifiedScheduleDisplay.css`
   - 결과: 선호시간은 파란색(#3b82f6) 블록, 개인시간은 빨간색(#ef4444) 블록으로 표시

2. **선호시간 블록 표시 개선** ✅ 완료 (문제 1과 함께 해결)
   - 증상: 현재 텍스트로만 표시됨 (예: "09-12 13-17")
   - 요구사항: PC 버전처럼 색상 블록으로 표시
   - 해결: 각 시간대마다 별도의 색상 블록으로 표시
   - 결과:
     - 블록들이 가로로 나열 (flex-direction: row)
     - 블록 안에 "12-13 점심시간" 형태로 한 줄 표시
     - 09-12이면 파란색 한 블록, 두 시간대면 두 블록

3. **블록 레이아웃 개선** ✅ 완료
   - 문제: 블록이 세로로 쌓임
   - 해결: `.schedule-blocks`를 `flex-direction: row`, `flex-wrap: wrap`로 변경
   - 문제: 블록 내부에서 시간과 이름이 세로로 표시됨
   - 해결: `.time-block`을 `flex-direction: row`로 변경
   - 최종 결과: "12-13 점심시간" 형태로 한 줄에 표시

4. **개인시간 디버깅 로그 추가** ✅ 완료
   - 개인시간이 표시되지 않는 문제 진단을 위해 상세 로그 추가
   - `slot.days`, `slot.daysOfWeek` 모두 체크하도록 수정
   - `slot.title`, `slot.name` 모두 처리하도록 수정
   - 콘솔에서 personalTimes 데이터 확인 가능

5. **선호시간/개인시간 스크롤 기능** ✅ 완료
   - 증상: 5개 이상의 시간대가 있을 때 레이아웃이 깨짐
   - 요구사항: 5개 이상이면 스크롤로 표시
   - 해결: SimplifiedScheduleDisplay에 max-height(300px) 및 overflow-y: auto 설정
   - 추가: 커스텀 스크롤바 스타일 적용 (6px 너비, 회색 톤)

6. **헤더 전체 누락** ✅ 완료
   - 증상: 로고, 로그아웃 등 헤더 전체가 사라짐
   - 원인: MobileScheduleView가 별도 라우트로 SchedulingSystem 헤더 미포함
   - 해결: MobileScheduleView에 별도 헤더 추가
   - 구성: 로고(MeetAgent 이미지 + 텍스트), 로그아웃 버튼
   - 파일: `MobileScheduleView.js`, `MobileScheduleView.css`

### ✅ 완료된 문제들 (2026-01-06)

7. **수정 버튼 재배치 및 기능 연결** ✅ 완료
   - 증상: 선호시간/개인시간 섹션 아래에 있던 버튼들의 위치가 부적절함
   - 해결:
     - "내 일정" 제목 오른쪽에 2개 버튼 배치 (시간표 수정, 개인시간 수정)
     - 버튼 크기 축소 (padding: 4px 8px, font-size: 10px)
     - 색상을 헤더 스타일과 통일 (회색 톤: #f3f4f6)
     - 클릭 시 PC 버전 "내 프로필" 탭으로 이동하도록 기능 연결
   - 파일: `MobileScheduleView.js` (line 509-531), `MobileScheduleView.css` (line 294-314)

8. **개인시간 달력 표시 및 색상 문제** ✅ 완료
   - 증상: 개인시간이 달력에 표시되지 않음, 색상이 핑크색임
   - 원인:
     - `pt.days` 필드를 체크하지 않음 (PC 버전과 불일치)
     - `pt.isRecurring` 필드를 체크하지 않음
     - 일요일 dayOfWeek 변환 누락 (0 → 7)
     - 색상이 빨간색이 아닌 핑크색으로 설정됨
   - 해결:
     - PC 버전과 동일한 로직으로 수정
     - `pt.days` 및 `pt.daysOfWeek` 모두 체크
     - `pt.isRecurring` 필드 체크 추가
     - 일요일을 7로 변환하는 로직 추가
     - 색상을 빨간색으로 변경 (backgroundColor: '#ef4444', borderColor: '#dc2626')
   - 파일: `MobileScheduleView.js` (line 122-176)

### ✅ 완료된 문제들 (2026-01-06 - 2차)

9. **버튼 이름 및 기능 수정** ✅ 완료
   - 증상: 버튼 이름이 부적절하고 엉뚱한 기능에 연결됨
   - 해결:
     - "시간표 수정" → "편집"으로 변경
     - "개인시간 수정" → "개인정보 수정"으로 변경
     - 편집 버튼: PC 버전 프로필 탭으로 이동 후 자동으로 편집 모드 활성화
     - 개인정보 수정 버튼: PC 버전 개인정보 수정 화면으로 자동 이동
   - 파일:
     - `MobileScheduleView.js` (line 512-531) - localStorage 설정
     - `ProfileTab/index.js` (line 78-85, 247-267) - 자동 모드 활성화 로직

10. **달력 "오늘" 버튼 제거** ✅ 완료
   - 증상: 불필요한 "오늘" 버튼이 표시됨
   - 해결: FullCalendar headerToolbar에서 'today' 제거
   - 파일: `MobileScheduleView.js` (line 540-544)

11. **달력 툴바 레이아웃 문제** ✅ 완료
   - 증상: 일간 뷰 등에서 제목이 길어지면 버튼들이 아래로 밀림
   - 원인: flex-wrap: wrap 설정으로 인한 줄바꿈 발생
   - 해결:
     - `flex-wrap: nowrap !important` 적용
     - 제목에 `max-width: 150px` 및 `text-overflow: ellipsis` 적용
     - 제목 폰트 크기 축소 (16px → 14px)
   - 파일: `MobileScheduleView.css` (line 505-521)

### ⚠️ 작업 대기 중

(없음)

---

## 🐛 해결된 문제들 (2026-01-05 - 1차)

### ✅ 완료
1. **개인시간 캘린더 미표시 문제**
   - 해결: `toISOString()` → `formatLocalDateTime()` 변경

2. **SimplifiedScheduleDisplay 병합 문제**
   - 해결: 연속 시간대 자동 병합 로직 추가

3. **개인시간 데이터 표시 누락**
   - 해결: personalTimes 데이터 구조 확인 및 표시 로직 수정

4. **설명 텍스트 누락**
   - 해결: 설명 텍스트 추가

5. **편집 버튼 누락 (1차)**
   - 해결: 편집 버튼 추가 (위치 재조정 필요)

6. **헤더 구조 문제 (1차)**
   - 해결: schedule-header 제거, "내 일정" 위치 변경 (추가 작업 필요)

---

## 📋 수정 작업 목록

### ✅ 완료된 수정 작업 (2026-01-05)
- ✅ MobileScheduleView.js 131, 154번 라인: `toISOString()` → `formatLocalDateTime()` 변경
- ✅ SimplifiedScheduleDisplay.js: 연속 시간대 병합 로직 추가
- ✅ SimplifiedScheduleDisplay.js: personalTimes 데이터 표시 로직 확인
- ✅ MobileScheduleView.js: 선호시간/개인시간 설명 텍스트 추가
- ✅ MobileScheduleView.js: 편집 버튼 추가 (시간표 수정, 개인시간 수정)
- ✅ MobileScheduleView.js: 헤더 구조 수정 ("내 일정" 위치 변경)

### Phase 4: 하단 버튼 기능 구현 (향후)
- ✅ 새로고침 버튼 구현
- [ ] 카메라 버튼 (기능 미정)
- [ ] 채팅 버튼 (기능 미정)
- [ ] 마이크 버튼 (기능 미정)

---

## 🗂️ 파일 구조

```
client/src/
├── components/
│   └── mobile/
│       ├── MobileDashboard.js          (메인 대시보드)
│       ├── MobileDashboard.css
│       ├── MobileCalendarView.js       (FullCalendar)
│       ├── MobileCalendarView.css
│       ├── MobileScheduleView.js       (일정 화면)
│       ├── MobileGroupView.js          (그룹 화면)
│       └── BottomNavigation.js         (하단 네비게이션)
├── hooks/
│   └── useMobileDetection.js           (기존 활용)
└── App.js                              (라우팅 설정)
```

---

## 🎨 UI 레이아웃

```
┌─────────────────────────┐
│  [≡] 헤더 (삼선 버튼)    │
├─────────────────────────┤
│                         │
│   ┌─────────────────┐   │
│   │   📅 일정      │   │  → 내 프로필 탭
│   └─────────────────┘   │
│                         │
│   ┌─────────────────┐   │
│   │   👥 그룹      │   │  → 일정맞추기 그룹
│   └─────────────────┘   │
│                         │
│   ┌─────────────────┐   │
│   │   📆 달력      │   │  → FullCalendar
│   └─────────────────┘   │
│                         │
├─────────────────────────┤
│  🔄  📷  💬  🎤        │  하단 네비게이션
└─────────────────────────┘
```

---

## 📌 우선순위

1. **높음**: Phase 1 (기본 구조)
2. **높음**: Phase 2 (FullCalendar)
3. **중간**: Phase 3 (화면 연결)
4. **낮음**: Phase 4 (추가 버튼 기능)

---

## 🔍 참고사항

- 기존 `useMobileDetection` 훅 활용
- 화면 너비 768px 이하 = 모바일
- FullCalendar 한국어 설정 필요
- 반응형 디자인 고려

---

## ✅ 체크리스트

- [ ] FullCalendar npm 패키지 설치
- [ ] MobileDashboard 컴포넌트 생성
- [ ] 3개 메뉴 버튼 UI 구현
- [ ] 하단 네비게이션 바 구현
- [ ] 새로고침 버튼 기능 구현
- [ ] FullCalendar 통합
- [ ] 라우팅 연결 (일정/그룹/달력)
- [ ] 모바일 테스트 (F12 > Toggle Device)

---

## 📝 메모

- 카메라, 채팅, 마이크 버튼은 추후 기능 정의 후 구현
- 기존 컴포넌트 최대한 재사용
- 모바일 최적화 우선

---

## 🔧 주요 수정 내역

### 4차 수정 - 버튼 기능 개선 및 달력 UI 수정 (2026-01-06 - 2차)
**날짜**: 2026-01-06

#### MobileScheduleView.js
1. **버튼 이름 및 기능 변경** (line 512-531)
   - "시간표 수정" → "편집"
   - "개인시간 수정" → "개인정보 수정"
   - localStorage에 플래그 설정 (`profileEditMode`, `showPersonalInfo`)

2. **달력 "오늘" 버튼 제거** (line 540-544)
   - headerToolbar에서 'today' 제거
   - left: 'prev,next today' → left: 'prev,next'

#### ProfileTab/index.js
1. **개인정보 모드 자동 활성화** (line 78-85)
   - localStorage의 `showPersonalInfo` 확인
   - true면 개인정보 수정 화면 자동 표시

2. **편집 모드 자동 활성화** (line 247-267)
   - localStorage의 `profileEditMode` 확인
   - 데이터 로드 완료 후 자동으로 편집 모드 활성화

#### MobileScheduleView.css
1. **달력 툴바 레이아웃 수정** (line 505-521)
   - `flex-wrap: nowrap !important` 적용
   - 제목 길이 제한 (`max-width: 150px`)
   - `text-overflow: ellipsis`로 말줄임표 처리
   - 폰트 크기 축소 (16px → 14px)

---

### 3차 수정 - 버튼 재배치 및 개인시간 수정 (2026-01-06 - 1차)
**날짜**: 2026-01-06

#### MobileScheduleView.js
1. **수정 버튼 재배치 및 기능 연결** (line 509-531)
   - "내 일정" 제목 오른쪽에 버튼 2개 배치
   - localStorage에 `activeTab='profile'` 설정 후 `/`로 이동
   - PC 버전 "내 프로필" 탭에서 편집 가능

2. **개인시간 처리 로직 개선** (line 122-176)
   - PC 버전과 동일한 로직으로 변경
   - `pt.days` 및 `pt.daysOfWeek` 모두 체크
   - `pt.isRecurring` 필드 체크 추가
   - 일요일 변환 로직 추가 (`dayOfWeek === 0 ? 7 : dayOfWeek`)
   - 색상을 빨간색으로 변경 (backgroundColor: '#ef4444', borderColor: '#dc2626')

#### MobileScheduleView.css
1. **schedule-page-title 레이아웃** (line 250-261)
   - flex 레이아웃으로 변경하여 제목과 버튼을 한 줄에 배치
   - `justify-content: space-between`으로 양쪽 정렬

2. **top-edit-buttons 스타일** (line 294-314)
   - 버튼 컨테이너 스타일 추가
   - 버튼 크기 축소 (padding: 4px 8px, font-size: 10px)
   - 색상을 헤더와 통일 (background: #f3f4f6, color: #4b5563)
   - hover/active 효과 추가

---

### 2차 수정 - 블록 UI 개선 (2026-01-05)
**날짜**: 2026-01-05

#### SimplifiedScheduleDisplay.js
1. **블록 UI 구현** (line 94-119)
   - 텍스트 표시 방식 → 색상 블록 표시 방식 변경
   - `preference-block` (파란색), `personal-block` (빨간색) 클래스 적용
   - 시간과 이름을 한 줄에 표시

2. **데이터 파싱 강화** (line 13-50)
   - `slot.days` 필드 추가 지원 (개인시간)
   - `slot.title` 또는 `slot.name` 모두 처리
   - 디버깅 로그 추가 (console.log)

#### SimplifiedScheduleDisplay.css
1. **블록 컨테이너 레이아웃** (line 20-25)
   - `flex-direction: row` - 블록들이 가로로 나열
   - `flex-wrap: wrap` - 공간 부족 시 자동 줄바꿈

2. **블록 스타일** (line 27-58)
   - `.time-block`: 기본 블록 스타일 (padding, border-radius)
   - `.preference-block`: 파란색 배경 (#3b82f6)
   - `.personal-block`: 빨간색 배경 (#ef4444)
   - 블록 내부: `flex-direction: row`로 시간과 이름 한 줄 표시

---

## 🔧 주요 수정 내역 (2026-01-05) - 1차

### 1. 타임존 문제 해결
**파일**: `MobileScheduleView.js` (line 131, 154)
- **문제**: 개인시간이 UTC로 변환되어 캘린더에 표시 안됨
- **해결**: `toISOString()` → `formatLocalDateTime()` 함수 사용
- **결과**: 개인시간이 정상적으로 월 뷰 캘린더에 표시됨

### 2. 시간대 병합 로직 추가
**파일**: `SimplifiedScheduleDisplay.js` (line 44-72)
- **문제**: 연속된 시간대가 병합되지 않고 개별로 표시됨 (예: 11-12, 12-13)
- **해결**: 정렬 후 연속 시간 자동 병합 로직 구현
- **결과**: 깔끔하게 병합된 시간대 표시 (예: 11-13)

### 3. 설명 텍스트 및 편집 버튼 추가
**파일**: `MobileScheduleView.js` (line 369-398)
- **추가 요소**:
  - 선호시간 설명: "클릭 또는 챗봇으로 추가한 가능한 시간들 (자동배정 시 사용됨)"
  - 개인시간 설명: "자동 스케줄링 시 이 시간들은 제외됩니다"
  - 시간표 수정 버튼
  - 개인시간 수정 버튼
- **스타일**: `MobileScheduleView.css` (line 69-96)

### 4. 헤더 구조 개선
**파일**: `MobileScheduleView.js` (line 408-415)
- **변경 전**: 별도 schedule-header로 "내 일정"만 표시 (로고/로그아웃 숨김)
- **변경 후**: schedule-header 제거, "내 일정"을 컨텐츠 영역 상단에 배치
- **결과**: 기존 SchedulingSystem 헤더(로고, 로그아웃 등) 유지됨

### 5. CSS 스타일 추가
**파일**: `MobileScheduleView.css`
- `.schedule-page-title` (line 29-36): 컨텐츠 영역 내 페이지 제목 스타일
- `.section-description` (line 69-74): 섹션 설명 텍스트 스타일
- `.edit-button` (line 76-96): 편집 버튼 스타일 (hover, active 효과 포함)

---

## 📖 개발 가이드 (2026-01-06 추가)

### 모바일에서 PC 기능 연동하기

#### 1. localStorage를 이용한 상태 전달
모바일에서 PC 버전의 특정 기능을 자동 활성화하려면 localStorage를 사용합니다.

**예시: 편집 모드 활성화**
```javascript
// 모바일에서 버튼 클릭 시
localStorage.setItem('activeTab', 'profile');
localStorage.setItem('profileEditMode', 'true');
window.location.href = '/';

// PC ProfileTab에서 확인
useEffect(() => {
  if (!isLoading && !isEditing) {
    const shouldEdit = localStorage.getItem('profileEditMode');
    if (shouldEdit === 'true') {
      localStorage.removeItem('profileEditMode'); // 사용 후 제거
      setIsEditing(true);
    }
  }
}, [isLoading, isEditing]);
```

**주의사항**:
- localStorage 값은 사용 후 반드시 제거하여 다음 방문 시 자동 활성화되지 않도록 합니다.
- 데이터 로딩이 완료된 후에 모드를 활성화해야 합니다.

#### 2. FullCalendar 커스터마이징

**툴바 버튼 제거**
```javascript
headerToolbar={{
  left: 'prev,next',        // 'today' 제거
  center: 'title',
  right: 'dayGridMonth,timeGridWeek,timeGridDay'
}}
```

**툴바 레이아웃 고정**
```css
.fc .fc-toolbar {
  flex-wrap: nowrap !important;  /* 줄바꿈 방지 */
}

.fc .fc-toolbar-title {
  max-width: 150px;              /* 최대 폭 제한 */
  text-overflow: ellipsis;        /* 말줄임표 */
  white-space: nowrap;            /* 한 줄로 표시 */
  overflow: hidden;
}
```

#### 3. 버튼 크기 및 색상 통일

작은 버튼을 헤더에 배치할 때는 다른 헤더 요소와 스타일을 맞춥니다:
```css
.top-edit-buttons .edit-button {
  padding: 4px 8px;
  font-size: 10px;
  background: #f3f4f6;  /* 헤더의 다른 버튼과 동일 */
  color: #4b5563;
}
```

### 문제 해결 가이드

#### 문제: 버튼 클릭 후 PC에서 모드가 활성화되지 않음
- **원인**: localStorage 값을 확인하는 useEffect의 의존성 배열이 잘못됨
- **해결**: 필요한 모든 상태를 의존성 배열에 포함

#### 문제: 달력 제목이 길어지면 버튼이 아래로 밀림
- **원인**: `flex-wrap: wrap` 설정
- **해결**: `flex-wrap: nowrap !important` 및 제목 폭 제한

#### 문제: 개인시간이 달력에 표시되지 않음
- **원인**: 서버 데이터의 필드명 불일치 (`days` vs `daysOfWeek`)
- **해결**: 두 필드를 모두 체크하는 로직 추가

---

## ✨ 현재 상태 요약 (2026-01-06 - 2차 업데이트)

### 완벽하게 작동하는 기능
- ✅ 모바일 대시보드 (일정/그룹/달력 버튼)
- ✅ FullCalendar 통합 (월/주/일 뷰, "오늘" 버튼 제거)
- ✅ **달력 툴바 레이아웃 고정 (제목 길어져도 버튼이 밀리지 않음)**
- ✅ 선호시간 캘린더 표시 (파란색 블록)
- ✅ **개인시간 캘린더 표시 (빨간색 블록, PC 버전과 동일한 로직)**
- ✅ 날짜 클릭 시 일 뷰 자동 전환
- ✅ 이벤트 병합 (연속 시간대)
- ✅ SimplifiedScheduleDisplay (색상 블록 UI)
- ✅ 설명 텍스트 표시
- ✅ **편집/개인정보 수정 버튼 - PC 버전 자동 연동**
  - 편집 버튼: PC 프로필 탭 편집 모드 자동 활성화
  - 개인정보 수정 버튼: PC 개인정보 수정 화면 자동 표시
- ✅ 올바른 헤더 구조 (로고/로그아웃 유지)
- ✅ 하단 네비게이션 (고정 위치)

### 향후 개발 예정
- 카메라 버튼 기능 정의 및 구현
- 채팅 버튼 기능 정의 및 구현
- 마이크 버튼 기능 정의 및 구현

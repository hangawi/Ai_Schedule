# 모바일 버전 개발 계획

## 🛠️ 개발 가이드
이 문서는 모바일 버전 개발 진행 상황을 추적하고 관리하기 위한 문서입니다. 작업 시 다음 절차를 따라주세요:

1.  **문제 기록**: 개발 중 발견된 버그나 개선 사항은 "🐛 새로 발견된 문제들" 섹션에 새로운 차수(예: 6차, 7차...)를 만들어 기록합니다.
2.  **해결 과정 작성**:
    *   **증상**: 문제가 무엇인지 명확히 기술합니다.
    *   **해결**: 어떻게 해결했는지 구체적인 로직이나 변경 사항을 적습니다.
    *   **파일**: 수정된 파일 목록을 나열합니다.
3.  **완료 처리**: 작업이 끝나면 제목 옆에 `✅ 완료`를 표시하고 내용을 정리합니다.
4.  **작업 대기**: 당장 해결하지 않을 문제는 "⚠️ 작업 대기 중" 섹션에 남겨둡니다.
5.  **최신화**: 작업이 끝날 때마다 이 문서를 최신 상태로 업데이트하여 현재 진행 상황을 공유합니다.

---

## 📅 작성일: 2026-01-05
## 🔄 최종 업데이트: 2026-01-08

---

## 🎯 목표
모바일 환경에서 대시보드 중심의 UI/UX 제공

---

## ✅ 완료된 작업

### Phase 1: 기본 구조 설정 (완료)
- ✅ `MobileDashboard.js` 컴포넌트 생성
- ✅ 모바일 감지 로직 통합 (useMobileDetection 활용)
- ✅ App.js에서 모바일일 때 대시보드 표시
- ✅ 상단 헤더 구현 (햄버거 메뉴, 로고, 로그아웃)
- ✅ 중앙 메뉴 버튼 3개 구현 (일정/그룹/달력)
- ✅ 하단 네비게이션 바 구현 (새로고침/카메라/채팅/마이크)

### Phase 2: FullCalendar 통합 (완료)
- ✅ FullCalendar 설치 완료
- ✅ `MobileScheduleView.js` 생성 및 FullCalendar 통합
- ✅ 한국어 설정 완료
- ✅ 날짜 클릭 시 일 뷰 자동 전환
- ✅ 기존 일정 API 연동 (선호시간/개인시간/예외일정)
- ✅ 타임존 문제 해결 (UTC → Local Time)
- ✅ 이벤트 병합 로직 구현 (mergeSlots)

### Phase 3: 화면 연결 (완료)
- ✅ 일정 버튼 → MobileScheduleView 연결
- ✅ 그룹 버튼 → MobileGroupsView 연결
- ✅ 달력 버튼 → MobileCalendarView 연결
- ✅ React Router 설정 완료
- ✅ SimplifiedScheduleDisplay 컴포넌트 생성 (깔끔한 디자인)

### Phase 4: UX 개선 및 버그 수정 (진행 중)
- ✅ 로그아웃 세션 종료 문제 해결 (#28)
- ✅ 페이지 이동 시 로그인 화면 깜빡임 해결 (#29)
- ✅ 방 입장 시 상단 중복 헤더 숨김 처리 (#38)
- ✅ 채팅봇 화이트 스크린 오류 및 위치 수정 (#39)
- ✅ 일정 분류 오류 수정 및 시간순 정렬 (#40)

### Phase 5: 대화형 자동 일정 조율 시스템 (Chat-to-Schedule) (진행 중)
- ✅ 1단계: 방 생성 모달에 '대화형 모드' 옵션 추가 (DB/UI 연동 완료)
- ✅ 2단계: 대화형 모드 전용 UI 및 실시간 그룹 채팅 구현 (카톡 스타일 적용)
- ⏳ 3단계: 대화 내용 분석 AI 엔진 및 백엔드 로직 구현 (테스트 대기)
- ⏳ 4단계: 일정 자동 감지 알림 및 원클릭 확정 UI 구현 (테스트 대기)
- ⏳ 5단계: UX 고도화 (스크롤, 알림, 모달 연결 수정)

---

## 🚀 Phase 5 상세 개발 계획

### 1단계: 방 생성 옵션 추가 (완료)
- `Room` 모델에 `mode` 필드 추가 (`standard` vs `conversational`).
- `RoomCreationModal`에 라디오 버튼 UI 추가 및 서버 연동.

### 2단계: 대화형 모드 전용 UI 및 실시간 채팅 (완료)
- **UI 분기**: `CoordinationTab`에서 방 모드에 따라 '시간표' 또는 '채팅창'을 메인으로 표시하도록 구현.
- **채팅 UI**: 카카오톡 스타일 적용 (내 메시지: 오른쪽/노란색, 상대 메시지: 왼쪽/흰색).
- **헤더 최적화**: 대화형 모드 전용 슬림/콤팩트 헤더 적용 (공간 효율성 증대).
- **정렬 로직 수정**: DB ID와 Firebase UID 혼용 문제를 해결하기 위해 **이메일(email) 기반 이중 체크 로직** 적용 완료.
- **실시간 통신**: Socket.io를 통한 다자간 실시간 메시지 전송 및 수신 환경 구축.

### 3단계: 대화 분석 AI 엔진 (The Brain) (구현 완료, 테스트 중)
- **목표**: 채팅 로그를 모니터링하여 일정 합의 신호를 감지.
- **작업 내용**:
  - 백엔드 메시지 훅(Hook): 메시지 저장 시 분석 트리거 가동.
  - LLM 프롬프트 엔지니어링: Gemini API를 이용해 대화 맥락에서 날짜, 시간, 장소 추출 (구문 오류 수정 완료).
  - 일정 감지 시 `schedule_suggestion` 소켓 이벤트 발송 로직 탑재.

### 4단계: 일정 피드백 및 확정 UI (구현 완료, 테스트 중)
- **목표**: AI가 제안한 일정을 사용자가 쉽게 확인하고 확정.
- **작업 내용**:
  - 채팅창 하단 'AI 일정 제안 카드' UI 구현 (확정/거절 버튼).
  - 확정 시 서버에 `confirm` 요청 -> `TimeSlot` 자동 생성 및 캘린더 연동.
  - 확정 완료 시 채팅방에 시스템 메시지 자동 전송.

---

## 🐛 새로 발견된 문제들 (2026-01-08 - 2차)

### 41. 대화형 모드 UI/UX 버그 수정
1. **방 설정 모달 미작동**
   - 증상: 대화형 모드 헤더의 '설정(톱니바퀴)' 버튼을 눌러도 반응이 없음.
   - 해결: `ConversationalRoomView`에서 `onManageRoom` 프롭 연결 상태 확인 및 수정.

2. **채팅 자동 스크롤 미흡**
   - 증상: 내가 메시지를 전송했을 때 화면이 맨 아래로 스크롤되지 않음.
   - 해결: `handleSend` 완료 직후 및 `messages` 상태 변경 시 `scrollToBottom` 강제 호출.

3. **안 읽은 메시지 알림 부재**
   - 증상: 방 목록에서 어떤 방에 새로운 채팅이 있는지 알 수 없음.
   - 해결:
     - DB: `Room` 멤버 정보에 `lastReadAt` 필드 추가.
     - API: 방 목록 조회 시 안 읽은 메시지 개수(`unreadCount`) 계산하여 반환.
     - UI: `RoomList`의 각 방 카드에 빨간색 숫자 배지 표시.
     - 로직: 방 입장 시 `lastReadAt` 업데이트 API 호출.
- ⏳ 3단계: 대화 내용 분석 AI 엔진 구현
- ⏳ 4단계: 일정 자동 감지 및 피드백 UI 구현

---

## 🐛 새로 발견된 문제들 (2026-01-05 - 2차)

### ✅ 완료된 문제들
1. **개인시간 빨간색 표시 누락** ✅ 완료
   - 증상: PC 버전에서는 빨간색으로 표시되던 개인시간이 모바일에서 안 보임
   - 원인: SimplifiedScheduleDisplay에서 색상 블록 표시 미구현
   - 해결: SimplifiedScheduleDisplay를 블록 UI로 변경
   - 파일: `SimplifiedScheduleDisplay.js`, `SimplifiedScheduleDisplay.css`
   - 결과: 선호시간은 파란색(#3b82f6) 블록, 개인시간은 빨간색(#ef4444) 블록으로 표시

2. **선호시간 블록 표시 개선** ✅ 완료 (문제 1과 함께 해결)
   - 증상: 현재 텍스트로만 표시됨 (예: "09-12 13-17")
   - 요구사항: PC 버전처럼 색상 블록으로 표시
   - 해결: 각 시간대마다 별도의 색상 블록으로 표시
   - 결과:
     - 블록들이 가로로 나열 (flex-direction: row)
     - 블록 안에 "12-13 점심시간" 형태로 한 줄 표시
     - 09-12이면 파란색 한 블록, 두 시간대면 두 블록

3. **블록 레이아웃 개선** ✅ 완료
   - 문제: 블록이 세로로 쌓임
   - 해결: `.schedule-blocks`를 `flex-direction: row`, `flex-wrap: wrap`로 변경
   - 문제: 블록 내부에서 시간과 이름이 세로로 표시됨
   - 해결: `.time-block`을 `flex-direction: row`로 변경
   - 최종 결과: "12-13 점심시간" 형태로 한 줄에 표시

4. **개인시간 디버깅 로그 추가** ✅ 완료
   - 개인시간이 표시되지 않는 문제 진단을 위해 상세 로그 추가
   - `slot.days`, `slot.daysOfWeek` 모두 체크하도록 수정
   - `slot.title`, `slot.name` 모두 처리하도록 수정
   - 콘솔에서 personalTimes 데이터 확인 가능

5. **선호시간/개인시간 스크롤 기능** ✅ 완료
   - 증상: 5개 이상의 시간대가 있을 때 레이아웃이 깨짐
   - 요구사항: 5개 이상이면 스크롤로 표시
   - 해결: SimplifiedScheduleDisplay에 max-height(300px) 및 overflow-y: auto 설정
   - 추가: 커스텀 스크롤바 스타일 적용 (6px 너비, 회색 톤)

6. **헤더 전체 누락** ✅ 완료
   - 증상: 로고, 로그아웃 등 헤더 전체가 사라짐
   - 원인: MobileScheduleView가 별도 라우트로 SchedulingSystem 헤더 미포함
   - 해결: MobileScheduleView에 별도 헤더 추가
   - 구성: 로고(MeetAgent 이미지 + 텍스트), 로그아웃 버튼
   - 파일: `MobileScheduleView.js`, `MobileScheduleView.css`

### ✅ 완료된 문제들 (2026-01-06)

7. **수정 버튼 재배치 및 기능 연결** ✅ 완료
   - 증상: 선호시간/개인시간 섹션 아래에 있던 버튼들의 위치가 부적절함
   - 해결:
     - "내 일정" 제목 오른쪽에 2개 버튼 배치 (시간표 수정, 개인시간 수정)
     - 버튼 크기 축소 (padding: 4px 8px, font-size: 10px)
     - 색상을 헤더 스타일과 통일 (회색 톤: #f3f4f6)
     - 클릭 시 PC 버전 "내 프로필" 탭으로 이동하도록 기능 연결
   - 파일: `MobileScheduleView.js` (line 509-531), `MobileScheduleView.css` (line 294-314)

8. **개인시간 달력 표시 및 색상 문제** ✅ 완료
   - 증상: 개인시간이 달력에 표시되지 않음, 색상이 핑크색임
   - 원인:
     - `pt.days` 필드를 체크하지 않음 (PC 버전과 불일치)
     - `pt.isRecurring` 필드를 체크하지 않음
     - 일요일 dayOfWeek 변환 누락 (0 → 7)
     - 색상이 빨간색이 아닌 핑크색으로 설정됨
   - 해결:
     - PC 버전과 동일한 로직으로 수정
     - `pt.days` 및 `pt.daysOfWeek` 모두 체크
     - `pt.isRecurring` 필드 체크 추가
     - 일요일을 7로 변환하는 로직 추가
     - 색상을 빨간색으로 변경 (backgroundColor: '#ef4444', borderColor: '#dc2626')
   - 파일: `MobileScheduleView.js` (line 122-176)

### ✅ 완료된 문제들 (2026-01-06 - 2차)

9. **버튼 이름 및 기능 수정** ✅ 완료
   - 증상: 버튼 이름이 부적절하고 엉뚱한 기능에 연결됨
   - 해결:
     - "시간표 수정" → "편집"으로 변경
     - "개인시간 수정" → "개인정보 수정"으로 변경
     - 편집 버튼: PC 버전 프로필 탭으로 이동 후 자동으로 편집 모드 활성화
     - 개인정보 수정 버튼: PC 버전 개인정보 수정 화면으로 자동 이동
   - 파일:
     - `MobileScheduleView.js` (line 512-531) - localStorage 설정
     - `ProfileTab/index.js` (line 78-85, 247-267) - 자동 모드 활성화 로직

10. **달력 "오늘" 버튼 제거** ✅ 완료
   - 증상: 불필요한 "오늘" 버튼이 표시됨
   - 해결: FullCalendar headerToolbar에서 'today' 제거
   - 파일: `MobileScheduleView.js` (line 540-544)

11. **달력 툴바 레이아웃 문제** ✅ 완료
   - 증상: 일간 뷰 등에서 제목이 길어지면 버튼들이 아래로 밀림
   - 원인: flex-wrap: wrap 설정으로 인한 줄바꿈 발생
   - 해결:
     - `flex-wrap: nowrap !important` 적용
     - 제목에 `max-width: 150px` 및 `text-overflow: ellipsis` 적용
     - 제목 폰트 크기 축소 (16px → 14px)
   - 파일: `MobileScheduleView.css` (line 505-521)

### ✅ 완료된 문제들 (2026-01-06 - 3차)

12. **버튼 작동 안 되는 문제 (forceDesktopMode)** ✅ 완료
   - 증상: 편집/개인정보 수정 버튼 클릭 시 초기화면(MobileDashboard)으로 돌아감
   - 원인: SchedulingSystem에서 `isMobile`이 true이면 무조건 MobileDashboard를 표시
   - 해결:
     - `forceDesktopMode` 플래그 추가 (localStorage)
     - SchedulingSystem에서 `isMobile && !forceDesktopMode` 조건으로 변경
     - 모바일 버튼 클릭 시 `forceDesktopMode: 'true'` 설정
   - 파일:
     - `SchedulingSystem.js` (line 179-189, 822, 862, 885)
     - `MobileScheduleView.js` (line 517, 528)

### ✅ 완료된 문제들 (2026-01-06 - 4차)

13. **모바일 전용 화면 생성** ✅ 완료
   - 증상: 편집/개인정보 수정 버튼이 PC 버전으로 리디렉션함
   - 요구사항: 모바일 전용 화면 생성 (PC 버전 참고)
   - 해결:
     - **MobilePersonalInfoEdit.js/css** 생성
       - 개인정보(이름, 성, 이메일, 전화번호, 주소, 직업, 생년월일) 수정 화면
       - 헤더에 뒤로가기/저장 버튼 배치
       - userService API 연동
       - 성공/오류 메시지 표시
     - **MobileScheduleEdit.js/css** 생성
       - 일정 편집 화면 (선호시간/개인시간)
       - 탭 UI로 선호시간과 개인시간 전환
       - CalendarView, PersonalTimeManager 컴포넌트 재사용
       - 저장/취소/전체 삭제 기능 제공
     - **MobileScheduleView.js** 통합
       - `showPersonalInfo` 상태로 개인정보 수정 화면 표시
       - `showScheduleEdit` 상태로 일정 편집 화면 표시
       - 버튼 클릭 시 모바일 화면 표시 (PC 버전 리디렉션 제거)
   - 파일:
     - 신규: `MobilePersonalInfoEdit.js`, `MobilePersonalInfoEdit.css`
     - 신규: `MobileScheduleEdit.js`, `MobileScheduleEdit.css`
     - 수정: `MobileScheduleView.js` (import, 상태, 조건부 렌더링, 버튼 핸들러)

### ✅ 완료된 문제들 (2026-01-06 - 5차)

14. **모바일 개인정보 수정 UI 개선 및 편집 모드 구현** ✅ 완료
   - 문제점:
     - 개인정보 수정 화면에서 헤더 저장 버튼이 중복
     - 입력 필드가 지도에 비해 너무 큼
     - 편집 버튼이 채팅봇만 토글하고 실제 편집 기능 부족
     - 초기화 버튼이 아이콘으로만 표시되어 의미가 불명확
   - 해결:
     - **개인정보 수정 화면 개선**:
       - 헤더의 저장 버튼 제거 (하단 저장 버튼만 유지)
       - 입력 필드 크기 축소 (padding: 12px → 8px, font-size: 16px → 14px)
       - 폼 간격 축소 (gap: 16px → 12px, 8px → 6px)
       - 전체적으로 더 컴팩트한 디자인
     - **편집 모드 구현**:
       - `isEditing` 상태 추가
       - 편집 버튼 클릭 시 편집 모드로 전환 + 채팅봇 자동 열림
       - 편집 모드일 때 "초기화"와 "저장" 버튼 표시
       - 일반 모드일 때 "편집"과 "개인정보 수정" 버튼 표시
     - **버튼 개선**:
       - 초기화 버튼: 아이콘(🗑️) → 텍스트("초기화")로 변경, 빨간색
       - 저장 버튼: 텍스트("저장"), 초록색
       - 채팅봇은 편집 모드일 때만 표시
   - 파일:
     - `MobilePersonalInfoEdit.js` - 헤더 저장 버튼 제거
     - `MobilePersonalInfoEdit.css` - 입력 필드 및 간격 크기 조정
     - `MobileScheduleView.js` - isEditing 상태, handleStartEdit/handleSave/handleClearAll 함수, 조건부 버튼 렌더링
     - `MobileScheduleView.css` - save-button 스타일 추가

### ✅ 완료된 문제들 (2026-01-06 - 6차)

15. **모바일 UX 개선 및 네비게이션 기능 강화** ✅ 완료
   - 문제점:
     - 달력에서 일/주 뷰로 들어가면 뒤로가기 버튼이 없어 불편함
     - 개인정보 수정 화면의 입력 필드가 여전히 큼
     - 편집 버튼을 눌러도 채팅봇이 어디 있는지 모르겠음
     - 하단 네비게이션 버튼들이 항상 표시되어 혼란스러움
   - 해결:
     - **달력 뒤로가기 기능**:
       - FullCalendar에 커스텀 버튼 추가 ("◀ 월")
       - 일/주 뷰에서 클릭 시 월 뷰로 돌아감
       - headerToolbar left에 'backToMonth' 버튼 추가
     - **개인정보 수정 필드 크기 추가 축소**:
       - padding: 8px → 6px
       - font-size: 14px → 13px
       - label font-size: 14px → 12px
       - 모든 gap 추가 축소 (12px → 8px, 6px → 4px)
     - **하단 네비게이션 개선**:
       - 편집 모드일 때만 표시
       - 각 버튼에 실제 기능 연결:
         - 새로고침: 일정 데이터 새로고침 (fetchSchedule)
         - 카메라: 사진으로 시간표 만들기 (개발 예정)
         - 채팅: 챗봇 토글 (setIsChatOpen)
         - 마이크: 음성 입력 (개발 예정)
   - 파일:
     - `MobileScheduleView.js` - FullCalendar customButtons, BottomNavigation 조건부 렌더링
     - `MobilePersonalInfoEdit.css` - 입력 필드 크기 추가 축소
     - `BottomNavigation.js` - props로 핸들러 받도록 수정

### ✅ 완료된 문제들 (2026-01-06 - 7차)

16. **OCR 시간표 추출 시스템 버그 수정 (대규모)** ✅ 완료
   - 증상:
     - "Cannot read properties of undefined (reading '0')" 에러 반복 발생
     - 서버에서 29개 스케줄 전송하지만 UI에 표시 안 됨
     - console에 "backgroundColor: undefined" 로그 반복 출력
     - 시간표 그리드가 완전히 비어있음 (legend hover는 작동)
   - 원인 분석 (다단계 디버깅):
     1. **서버 사이드 타입 체크 누락**: scheduleAutoOptimizer.js에서 `s.startTime.split(':')[0]` 실행 전 타입 체크 없음
     2. **클라이언트 초기화 문제**: useModalState.js에서 `modifiedCombinations[currentIndex]` 접근 시 undefined
     3. **응답 데이터 누락**: ocrController.js에서 `optimalCombinations` 필드를 응답에 포함하지 않음
     4. **Props 누락**: ScheduleView.js에서 `combinations` prop을 전달하지 않음 (initialSchedules만 전달)
     5. **⭐ ROOT CAUSE - Days 형식 변환 버그**: scheduleTransform.js의 `convertToPersonalTimes`에서 spread operator 순서 문제
        - `days: mappedDays` (숫자 배열 [1, 2])로 변환 후 → `...schedule` spread로 다시 `days: ['MON', 'TUE']`로 덮어씌움
        - JavaScript dayOfWeek는 숫자 (0=일요일, 1=월요일, ...)
        - 필터 조건 `personalDays.includes(dayOfWeek)` → `['MON'].includes(1)` → false → 모든 일정 제외됨
   - 해결:
     - **server/utils/scheduleAutoOptimizer.js**:
       - Line 353-358: `s.startTime`이 string인지 체크 후 split 실행
       - Line 202-213: JSON 파싱 try-catch 추가, 배열 검증 강화
     - **server/controllers/ocrController.js**:
       - Line 264-291: 유효하지 않은 스케줄 필터링 (startTime/endTime/title 체크)
       - Line 425-446: 응답에 `optimalCombinations: [optimizationResult.optimizedSchedules]` 추가
     - **client/src/components/modals/hooks/useModalState.js**:
       - Line 12-14: `modifiedCombinations`를 useState로 초기화 (prop 직접 사용 금지)
       - Line 53-60: 배열 및 인덱스 안전성 체크 추가
     - **client/src/components/modals/utils/timeUtils.js**:
       - Line 100-122: `getTimeRange`에서 startTime/endTime이 string인지 확인 후 split
       - 모든 시간 계산 함수에 타입 체크 추가
     - **client/src/components/chat/components/ScheduleView.js** ⭐ CRITICAL:
       - Line 51: `combinations={filteredSchedules ? [filteredSchedules] : []}` prop 추가
       - initialSchedules만 전달하던 문제 해결
     - **⭐ client/src/components/modals/utils/scheduleTransform.js** - ROOT CAUSE FIX:
       - Line 100-121: spread operator 순서 변경
       - BEFORE (잘못된 순서):
         ```javascript
         const converted = {
           days: mappedDays,  // ✅ [1, 2, 3]
           ...schedule        // ❌ days를 ['MON', 'TUE']로 덮어씀!
         };
         ```
       - AFTER (올바른 순서):
         ```javascript
         const converted = {
           ...schedule,       // ⭐ 먼저 원본 속성 복사
           days: mappedDays   // ⭐ 그 다음 변환된 days로 덮어쓰기
         };
         ```
   - 디버깅 과정:
     - 전체 데이터 플로우에 상세 로그 추가 (server → client → modal → grid → rendering)
     - console.log로 각 단계별 데이터 형식 추적
     - days 필드가 ['MON'] 형태로 유지되는 것 발견
     - spread operator 순서가 변환된 값을 덮어쓰는 것 확인
   - 결과:
     - ✅ 서버/클라이언트 모든 타입 에러 해결
     - ✅ OCR 추출 29개 스케줄 → UI에 정상 표시
     - ✅ 시간표 그리드에 모든 일정 렌더링 성공
     - ✅ days 형식 변환 완벽 작동 (한글/영문 → 숫자)

### ✅ 완료된 문제들 (2026-01-06 - 8차)

17. **모바일 시간표 업로드 모달 최적화** ✅ 완료
   - 요구사항:
     - 이미지 미리보기를 4개만 표시
     - 5개 이상일 경우 스크롤로 표시
     - "시간표 분석 시작" 버튼 텍스트 크기 축소 (모바일 환경)
   - 해결:
     - **ImagePreviewGrid.js** (Line 48-53):
       - `maxHeight: '280px'` 추가 (2행 × 128px + gap 8px + 여유)
       - `overflowY: 'auto'` 추가 (5개 이상이면 스크롤)
       - 2열 그리드 유지 → 4개 이미지 = 2행 완벽하게 표시
     - **TimetableUploadWithChat.js** (Line 291-299):
       - 버튼에 `style={{ fontSize: isMobile ? '14px' : '16px' }}` 추가
       - 모바일에서 텍스트 크기 16px → 14px로 축소
   - 결과:
     - ✅ 모바일에서 4개 이미지만 보이고 깔끔한 UI
     - ✅ 5개 이상 업로드 시 자동으로 스크롤 생성
     - ✅ 버튼 텍스트가 모바일에 최적화된 크기로 표시

### ✅ 완료된 문제들 (2026-01-06 - 9차)

18. **모바일 그룹 화면 헤더 추가 및 UI 개선** ✅ 완료
   - 증상:
     - "일정맞추기 그룹"과 "일정맞추기" 제목이 중복됨
     - 헤더가 없어서 로고/로그아웃 버튼이 없음
     - BottomNavigation이 항상 표시되어 혼란스러움 (편집 모드 전용이어야 함)
   - 해결:
     - **MobileGroupsView.js**:
       - lucide-react에서 Menu, LogOut, Calendar 아이콘 import
       - isSidebarOpen 상태 추가
       - handleLogout 함수 추가
       - "일정맞추기 그룹" 제목 제거
       - MobileScheduleView와 동일한 헤더 구조 추가:
         - 사이드바 (햄버거 메뉴)
         - 모바일 헤더 (로고 + 버튼들)
         - 페이지 제목 "일정맞추기"로 변경
       - BottomNavigation 완전 제거
     - **MobileGroupsView.css**:
       - 모바일 헤더 스타일 추가 (.mobile-header, .mobile-header-content 등)
       - 사이드바 스타일 추가 (.sidebar-overlay, .mobile-sidebar 등)
       - 페이지 제목 스타일 추가 (.groups-page-title)
       - 기존 .groups-header, .groups-title 스타일 제거
       - groups-content의 padding-bottom 제거 (BottomNavigation 없으므로)
       - 미디어 쿼리 업데이트
   - 결과:
     - ✅ MobileScheduleView와 일관된 헤더 디자인
     - ✅ "일정맞추기" 단일 제목으로 깔끔하게 정리
     - ✅ BottomNavigation 제거로 혼란 해소
     - ✅ 햄버거 메뉴, 로고, 로그아웃 버튼 정상 작동

### ✅ 완료된 문제들 (2026-01-06 - 10차)

19. **모바일 그룹 화면 버튼 추가 및 로그인 깜빡임 수정** ✅ 완료 (변경됨 - 10차에서 11차로)
   - 원래 추가한 "새 조율방 생성", "조율방 참여" 버튼은 삭제됨
   - 로그인 깜빡임 문제는 해결 완료

### ✅ 완료된 문제들 (2026-01-06 - 11차)

20. **모든 모바일 페이지 헤더 완전 통일 및 BottomNavigation 제거** ✅ 완료
   - 문제점:
     - 홈(MobileDashboard): 헤더 없음, BottomNavigation만 있음
     - 그룹(MobileGroupsView): 헤더 불완전, "새 조율방 생성/조율방 참여" 버튼 불필요
     - 달력(MobileCalendarView): 헤더 없음, BottomNavigation 있음
     - 모든 페이지에서 BottomNavigation이 보임 (편집 모드에서만 보여야 함)
     - 로고 클릭 시 로그인 화면 깜빡임
   - 해결:
     - **MobileDashboard.js**:
       - lucide-react import 추가 (Menu, LogOut, Calendar)
       - useState로 isSidebarOpen 상태 추가
       - handleLogout 함수 추가
       - 사이드바 + 모바일 헤더 추가 (MobileScheduleView와 동일)
       - BottomNavigation 완전 제거
     - **MobileDashboard.css**:
       - 헤더 스타일 추가 (.mobile-header, .mobile-header-content 등)
       - 사이드바 스타일 추가 (.sidebar-overlay, .mobile-sidebar 등)
       - padding-bottom: 80px 제거 (BottomNavigation 제거)
     - **MobileCalendarView.js**:
       - useNavigate 추가, lucide-react import 추가
       - isSidebarOpen 상태 추가, handleLogout 함수 추가
       - 사이드바 + 모바일 헤더 추가
       - calendar-page-title 추가 ("달력")
       - BottomNavigation 완전 제거
     - **MobileCalendarView.css**:
       - 헤더 스타일 추가
       - 사이드바 스타일 추가
       - calendar-page-title 스타일 추가
       - calendar-header 스타일 제거
       - padding-bottom: 80px 제거
     - **MobileGroupsView.js**:
       - "새 조율방 생성", "조율방 참여" 버튼 제거
       - groups-page-title을 단순화 (제목 + notification badge만)
     - **모든 페이지 공통**:
       - 헤더 구조 완전 동일:
         - 왼쪽: 햄버거 메뉴 + MeetAgent 로고
         - 오른쪽: 캘린더 아이콘 + 로그아웃 버튼
       - 사이드바 메뉴 완전 동일:
         - 🏠 홈으로 → navigate('/')
         - 📅 내 일정 → navigate('/mobile/schedule')
         - 👥 그룹 → navigate('/mobile/groups')
         - 📆 달력 → navigate('/mobile/calendar')
       - 로고 클릭 시 navigate('/') (깜빡임 없음, useAuth.js 수정으로 해결)
   - 결과:
     - ✅ 홈/일정/그룹/달력 모든 페이지 헤더 완전 통일
     - ✅ BottomNavigation 모든 페이지에서 제거 (일정 페이지 편집 모드에서만 표시)
     - ✅ 사이드바 네비게이션 모든 페이지에서 동일하게 작동
     - ✅ 로고 클릭 시 로그인 화면 깜빡임 완전 해결
     - ✅ 일관된 사용자 경험 제공

### ✅ 완료된 문제들 (2026-01-06 - 12차) - 최종 완벽 통일

21. **모든 모바일 페이지 헤더 완벽 통일 및 중복 제거** ✅ 완료
   - 문제점:
     - 그룹 페이지 내부에 "일정 맞추기" 제목과 "새 조율방 생성/조율방 참여" 버튼 중복
     - 홈/그룹/달력 페이지 헤더 아이콘들이 일정 페이지와 다름
     - 홈 페이지 스크롤 발생
     - 로고 클릭 시 window.location.href 사용으로 로그인 화면 깜빡임
   - 해결:
     - **RoomList.js** (그룹 페이지 내부):
       - Line 65-81: "일정 맞추기" 제목 및 "새 조율방 생성/조율방 참여" 버튼 완전 삭제
       - 중복 제거 완료
     - **모든 페이지 헤더를 MobileScheduleView 기준으로 완벽 통일**:
       - **왼쪽**: 햄버거 메뉴 + MeetAgent 로고
       - **오른쪽 (순서대로)**:
         1. Calendar 아이콘
         2. Clipboard/ClipboardX 아이콘 (클립보드 모니터링)
         3. Phone 아이콘 (백그라운드 모니터링)
         4. 프로필 버튼 (user.firstName)
         5. 음성 인식 버튼 (🎙️/🔇)
         6. 로그아웃 버튼 (LogOut)
     - **MobileDashboard.js**:
       - lucide-react import 추가 (Clipboard, ClipboardX, Phone, User)
       - isClipboardMonitoring, isBackgroundMonitoring, isVoiceEnabled 상태 추가
       - 헤더 오른쪽 버튼 6개 모두 추가
       - 로고: button → div + navigate('/')
       - user prop 추가
     - **MobileDashboard.css**:
       - .mobile-profile-btn, .mobile-voice-btn, .mobile-logout-btn 스타일 추가
       - dashboard-content padding: 16px → 8px (스크롤 제거)
     - **MobileGroupsView.js**:
       - useNavigate 추가
       - lucide-react import 추가
       - 모든 상태 추가
       - 헤더 오른쪽 버튼 6개 모두 추가
       - 로고: window.location.href → navigate('/')
       - 사이드바 메뉴: window.location.href → navigate('/')
     - **MobileGroupsView.css**:
       - 버튼 스타일 추가
     - **MobileCalendarView.js**:
       - lucide-react import 추가
       - 모든 상태 추가
       - 헤더 오른쪽 버튼 6개 모두 추가
       - 로고: button → div + navigate('/')
       - user prop 추가
     - **MobileCalendarView.css**:
       - 버튼 스타일 추가
     - **MobileScheduleView.js**:
       - 로고: button → div (기존 window.location.href 유지)
   - 결과:
     - ✅ 모든 페이지 헤더 아이콘 개수/순서/스타일 완벽 통일
     - ✅ 그룹 페이지 내부 중복 제목/버튼 완전 제거
     - ✅ 홈 페이지 스크롤 제거 (padding 축소)
     - ✅ navigate() 사용으로 로그인 깜빡임 방지 (일부 제외)
     - ✅ 완벽하게 통일된 모바일 UI 완성

### ✅ 완료된 문제들 (2026-01-06 - 13차) - 최종 기능 스왑 및 페이지 업데이트

22. **일정/달력 페이지 기능 맞교환 및 사이드바 업데이트** ✅ 완료
   - 요구사항: 
     - "일정" 클릭 시 빈 페이지(헤더만 유지) 표시
     - "달력" 클릭 시 기존의 상세 일정(FullCalendar + 선호/개인시간) 페이지 표시
     - 사이드바 및 대시보드 버튼 링크 업데이트
   - 해결:
     - **MobileScheduleView.js**:
       - 기존의 모든 일정 관련 로직, 상태, UI(FullCalendar, SimplifiedScheduleDisplay 등) 제거
       - 헤더와 빈 컨텐츠 영역만 남긴 심플한 컴포넌트로 변경
     - **MobileCalendarView.js**:
       - MobileScheduleView.js에 있던 모든 로직과 UI를 이식
       - FullCalendar, SimplifiedScheduleDisplay, BottomNavigation, 편집 모드 등 모든 기능 통합
       - 페이지 제목을 "달력"으로 변경
     - **MobileDashboard.js**:
       - 사이드바 메뉴 링크 수정:
         - "내 일정" → `/mobile/calendar` (상세 뷰)
         - "달력" → `/mobile/schedule` (빈 뷰)
       - 대시보드 버튼 핸들러 수정:
         - 일정 버튼 → `/mobile/calendar`
         - 달력 버튼 → `/mobile/schedule`
   - 결과:
     - ✅ "일정" 메뉴는 깔끔한 빈 페이지로 초기화됨
     - ✅ "달력" 메뉴에서 기존의 강력한 일정 관리 기능을 모두 사용 가능
     - ✅ 사용자 경험에 맞게 네비게이션 구조 재정립

### ✅ 완료된 문제들 (2026-01-06 - 14차)

23. **홈 화면 헤더 정렬 불일치 및 달력 사용자 정보 누락 수정** ✅ 완료
   - 문제점: 
     - 홈 화면(MobileDashboard)이 SchedulingSystem의 패딩(`p-4`) 안에 갇혀 있어 헤더가 다른 페이지보다 낮게 표시됨
     - `/mobile/calendar` 페이지에 `user` 정보가 전달되지 않아 프로필 버튼 등이 정상 표시되지 않음
   - 해결:
     - **SchedulingSystem.js**: 모바일 모드일 때 메인 컨텐츠 영역의 패딩을 제거하는 조건부 클래스 추가
     - **App.js**: `/mobile/calendar` 라우트에 `user` prop 전달 및 인증 보호 로직 추가
   - 결과: 
     - ✅ 이제 모든 모바일 페이지의 헤더 위치가 완벽하게 일치함
     - ✅ 달력 페이지에서도 사용자 이름과 프로필 정보가 정상 표시됨

### ✅ 완료된 문제들 (2026-01-07 - 확정된 일정 표시 및 모바일 일정 뷰)

24. **확정된 일정 표시 기능 구현** ✅ 완료
   - 요구사항: "일정 맞추기" 탭에서 확정된 일정을 PC/모바일 대시보드에 표시
   - 해결:
     - **데이터 소스 변경**:
       - 원래 계획: `Room.timeSlots` (status: 'confirmed') 사용
       - 실제 구현: `User.personalTimes` 사용 (confirmScheduleService.js가 여기에 저장)
       - 확정된 일정은 `{room.name} - {ownerName}` 형식의 title로 저장됨
     - **SchedulingSystem.js**:
       - `fetchConfirmedSchedules` 제거 → `fetchPersonalTimes` 사용
       - `/api/users/profile/schedule`에서 personalTimes 조회
       - 날짜 필터링 로직 구현:
         - pastEvents: 30일 전 ~ 오늘 (미포함)
         - todayEvents: 오늘 (문자열 비교로 정확도 향상)
         - upcomingEvents: 오늘 이후
       - personalTimes에서 `title.includes('-')`로 확정 일정 구분
     - **DashboardTab.js**:
       - "진행 중인 조율" 섹션 완전 제거
       - 통계 카드 4개 → 3개로 축소
       - ProposalCard 컴포넌트 제거
       - EventCard로 통일하여 표시
     - **MobileDashboard.js**:
       - 요약 카드 제거 (홈 화면에서 삭제)
       - 깔끔한 3개 메뉴 버튼만 유지
   - 결과:
     - ✅ 확정된 일정이 PC/모바일 대시보드에 정상 표시
     - ✅ 개인 일정과 확정 일정 병합하여 시간순 정렬
     - ✅ 날짜 필터링 정확도 향상 (문자열 비교)

25. **모바일 일정 뷰 구현** ✅ 완료
   - 요구사항: 모바일 "일정" 버튼 클릭 시 지난/오늘/예정 일정을 탭으로 표시
   - 해결:
     - **MobileScheduleView.js** 대규모 개편:
       - 빈 페이지에서 → 완전한 일정 관리 페이지로 변경
       - 탭 UI 추가: 지난 일정 / 오늘 일정 / 예정 일정
       - `fetchEvents`, `fetchPersonalTimes` 함수 추가
       - useMemo로 일정 필터링 및 **시간순 정렬** (`sortByDateTime`)
       - EventCard 컴포넌트: 일정 카드 표시 (별점 제거)
       - EventDetailModal: 일정 상세 정보 모달 (bottom sheet 애니메이션)
         - 모임이름, 날짜, 시간, 장소, 인원수, 조율방 정보 표시
         - 날짜 포맷팅: "2026년 1월 7일 (화)" 형식
         - 시간 계산: 시작~종료 시간 및 지속 시간 표시
       - MapModal: 지도 표시 모달
         - 사용자 주소 표시
         - Google Maps iframe 임베드
         - 주소 또는 좌표 기반 지도 표시
       - 장소 클릭 시 지도 모달 열기
     - **MobileScheduleView.css**:
       - 탭 스타일, 일정 카드 스타일, 모달 스타일 추가
       - 확정 일정 카드에 초록색 테두리 및 배경 효과
       - slideUp, fadeIn 애니메이션 추가
       - 장소 클릭 가능 스타일 (hover 효과, 지도 힌트)
       - 지도 모달 스타일 (bottom sheet)
   - 결과:
     - ✅ 지난/오늘/예정 일정을 탭으로 깔끔하게 분리
     - ✅ 일정 클릭 시 상세 정보 모달로 표시
     - ✅ 시간순 정렬로 일정 확인 편리
     - ✅ 사용자 주소를 장소로 표시하고 클릭 시 지도 표시
     - ✅ 확정된 일정은 초록색으로 구분 표시

26. **일정 시간순 정렬 기능** ✅ 완료
   - 요구사항: 일정을 시간 순서대로 배치
   - 해결:
     - **MobileScheduleView.js** (Line 322-331):
       - `sortByDateTime` 함수 구현
       - 날짜 비교 후 같은 날이면 시간 비교
       - pastEvents, todayEvents, upcomingEvents 모두 정렬 적용
     - 정렬 로직:
       ```javascript
       const sortByDateTime = (a, b) => {
         const dateCompare = a.date.localeCompare(b.date);
         if (dateCompare !== 0) return dateCompare;
         const timeA = a.time || '00:00';
         const timeB = b.time || '00:00';
         return timeA.localeCompare(timeB);
       };
       ```
   - 결과:
     - ✅ 모든 일정이 날짜 → 시간 순으로 정렬
     - ✅ 같은 날의 일정은 시간 빠른 순으로 표시

27. **장소 표시 및 지도 모달 기능** ✅ 완료
   - 요구사항:
     - 장소를 사용자 주소로 표시
     - 장소 클릭 시 Google Maps 모달 표시
   - 해결:
     - **EventDetailModal 업데이트**:
       - 장소 섹션을 클릭 가능하게 변경
       - `user.address + user.addressDetail` 표시
       - "📍 지도 보기" 힌트 추가
       - 클릭 시 `onOpenMap` 호출
     - **MapModal 컴포넌트**:
       - Google Maps iframe 임베드
       - 좌표 또는 주소 기반 지도 표시
       - Bottom sheet 스타일 모달
       - 주소 정보 상단에 표시
     - **상태 관리**:
       - `showMapModal`, `selectedLocation` 상태 추가
       - `handleOpenMap`, `handleCloseMapModal` 함수 추가
     - **CSS 스타일**:
       - `.modal-location-section`: 클릭 가능 표시 (hover 효과)
       - `.map-modal`: 지도 모달 스타일
       - `.map-content`, `.map-address`, `.map-container`: 지도 컨텐츠 스타일
   - 결과:
     - ✅ 사용자 주소가 장소로 정상 표시
     - ✅ 장소 클릭 시 Google Maps 모달 열림
     - ✅ 주소와 지도가 함께 표시되어 위치 확인 편리

---

## 🎉 현재 상태 요약

### 완료된 기능
- ✅ 모바일 전용 대시보드 구현
- ✅ FullCalendar 통합 및 일정 표시
- ✅ 모바일 헤더 완전 통일 (홈/일정/그룹/달력)
- ✅ OCR 시간표 추출 시스템 완벽 작동
- ✅ 확정된 일정 표시 (PC/모바일)
- ✅ 모바일 일정 뷰 (탭, 카드, 상세 모달, 시간순 정렬)
- ✅ 장소 및 지도 표시 기능

### 모바일 페이지 구조
```
/                        → MobileDashboard (홈, 3개 메뉴 버튼)
/mobile/schedule        → MobileScheduleView (일정 탭 뷰: 지난/오늘/예정)
/mobile/groups          → MobileGroupsView (일정맞추기 그룹)
/mobile/calendar        → MobileCalendarView (상세 일정, FullCalendar + 선호시간/개인시간)
```

---

## 🐛 새로 발견된 문제들 (2026-01-07 - 2차)

### ✅ 완료된 문제들 (2026-01-07 - 2차)

30. **그룹 화면에서 즉시 특정 방에 들어가는 문제 및 중복 헤더 수정** ✅ 완료
   - 증상:
     - 그룹 탭 클릭 시 이전에 들어갔던 방으로 자동 입장되어 방 목록을 볼 수 없음
     - "일정맞추기" 제목과 버튼들이 헤더와 본문에 중복 표시됨
   - 해결:
     - **방 상태 초기화 강제**: `MobileGroupsView` 진입 시 `useCoordination` 훅의 `skipRestore` 옵션을 통해 `localStorage`의 이전 방 정보를 무시하고 초기화하도록 수정
     - **리마운트 처리**: `useLocation().key`를 사용하여 탭 재진입 시 컴포넌트를 완전히 새로고침
     - **중복 헤더 제거**: `CoordinationTab`과 `RoomList`에 `hideHeader` prop을 추가하여 모바일에서는 내부 헤더를 숨김
   - 파일: `MobileGroupsView.js`, `CoordinationTab/index.js`, `RoomList.js`, `useCoordination.js`

31. **달력 페이지 선호시간/개인시간 디자인 및 UI 개선** ✅ 완료
   - 증상:
     - 선호시간/개인시간 섹션이 세로로 배치되어 공간 낭비 및 디자인 깨짐
     - "달력" 제목과 편집 버튼들의 정렬이 맞지 않음
   - 해결:
     - **레이아웃 수정**: `.sections-container`를 `flex-direction: row`로 고정하고 `overflow-x: auto` 적용하여 가로 스크롤 가능한 구조로 변경
     - **반응형 처리**: 섹션의 `min-width`를 제거하여 작은 화면에서도 자연스럽게 축소되도록 수정
     - **헤더 정렬**: 제목과 버튼을 `space-between`으로 배치하고 하단 구분선 추가
   - 파일: `MobileCalendarView.css`

28. **로그아웃을 해도 로그인이 되는 문제** ✅ 완료
   - 증상: 로그아웃 버튼을 눌러도 로그아웃이 안 되고 다시 로그인된 상태로 돌아옴
   - 원인: Firebase 세션이 완전히 종료되지 않고 로컬 스토리지만 지워져서 발생
   - 해결:
     - 모든 모바일 페이지의 `handleLogout` 함수 수정
     - `auth.signOut()`을 명시적으로 호출하여 Firebase 세션 종료
     - `navigate('/auth')`를 사용하여 클라이언트 라우팅으로 이동
   - 파일: `MobileDashboard.js`, `MobileScheduleView.js`, `MobileGroupsView.js`, `MobileCalendarView.js`

29. **페이지 이동 시 로그인 화면 깜빡임 문제** ✅ 완료
   - 증상: 로그인된 상태에서 버튼을 눌러 페이지를 이동할 때 잠깐 로그인 화면이 보였다가 다시 원래 페이지로 돌아옴
   - 원인: `window.location.href` 사용으로 페이지 전체 리로드 발생 → 앱 초기화 시 로그인 상태 체크하는 동안 잠깐 비로그인 상태로 인식됨
   - 해결:
     - 모든 `window.location.href`를 React Router의 `navigate()`로 변경
     - SPA(Single Page Application) 방식의 부드러운 화면 전환 구현
   - 파일: `MobileGroupsView.js`, `RoomList.js` 등 관련 파일 일괄 수정

### ✅ 완료된 문제들 (2026-01-07 - 3차)

32. **지난일정 주소 표시 오류 (조원 주소 표시)** ✅ 완료
   - 증상: 모바일 "일정" 페이지 → 지난/오늘/예정 일정 → 일정 클릭 시 모든 일정에 본인 주소만 표시됨
   - 원인:
     - DB에 저장된 기존 personalTimes에 location 정보가 없음
     - 클라이언트에서 user.address만 표시하도록 하드코딩되어 있음
   - 해결:
     - **서버 수정** (`userController.js` - `getUserSchedule`):
       - personalTimes를 반환할 때, 확정된 일정(title에 '-' 포함)이면:
       - title에서 조원/방장 이름을 파싱하여 DB에서 해당 사용자를 검색
       - 검색된 사용자의 주소(location, locationLat, locationLng)를 실시간으로 추가하여 반환
     - **서버 수정** (`confirmScheduleService.js`):
       - 앞으로 확정될 일정에는 저장 시점부터 location 정보 포함
       - 조원: 방장의 주소 저장 / 방장: 각 조원의 주소 저장
     - **클라이언트 수정** (`MobileScheduleView.js`):
       - fetchPersonalTimes에서 location, locationLat, locationLng 필드 읽기
       - EventDetailModal에서 event.location 우선 표시, 없으면 user.address 표시
   - 결과:
     - ✅ 조원: 방장의 주소가 표시됨 (어디로 가야 하는지)
     - ✅ 방장: 각 조원의 주소가 표시됨 (누구 집으로 가는지)
     - ✅ 기존 DB 데이터도 실시간 조회로 올바른 주소 표시
   - 파일: `userController.js`, `confirmScheduleService.js`, `MobileScheduleView.js`

### ✅ 완료된 문제들 (2026-01-07 - 4차)

33. **일정 표시 개선: 이동시간 병합 및 교통정보 표시** ✅ 완료
   - 증상:
     - 방장의 일정이 "이동시간"과 "수업시간" 두 개로 분리되어 표시됨
     - 이동시간의 주소가 방장 집(출발지)으로 표시됨
     - 교통수단, 소요시간 정보가 표시되지 않음

   - 목표:
     - **이동시간 + 수업시간 병합**:
       - 예) 9:00-10:00 이동시간 + 10:00-11:00 수업 → 9:00-11:00 하나의 일정으로 표시
     - **장소 클릭 시 상세 정보 표시**:
       - 목적지 주소 (조원/방장 집)
       - 교통수단 (🚗 자동차 / 🚇 대중교통 / 🚶 도보)
       - 소요 시간 (예: 약 30분)
       - 지도에서 경로 표시 (출발지 → 목적지)

   - 구현 계획:
     1. **데이터 준비** (서버):
        - `confirmScheduleService.js`: personalTimes 저장 시 교통수단(transportMode) 추가
        - `userController.js`: getUserSchedule에서 교통수단 정보 포함하여 반환

     2. **일정 병합 로직** (클라이언트):
        - `MobileScheduleView.js`: fetchPersonalTimes에서 이동시간과 수업시간 감지
        - 같은 날, 연속된 시간, "이동시간" 포함 제목 → 병합
        - 병합된 일정: 시작시간=이동시간 시작, 종료시간=수업시간 종료

     3. **상세 정보 UI** (클라이언트):
        - `MobileScheduleView.js` EventDetailModal 수정:
          - 교통수단 아이콘 및 텍스트 표시
          - 소요 시간 표시
          - 경로 보기 버튼 추가

     4. **지도 경로 표시** (클라이언트):
        - 카카오맵 API의 경로 표시 기능 활용
        - 출발지(사용자 주소) → 목적지(조원/방장 주소) 경로 그리기

   - 적용 범위:
     - ✅ 모바일 일정 페이지 (지난일정/오늘일정/예정일정)에만 적용
     - ❌ PC 버전, 달력 페이지는 기존 방식 유지

   - 구현 완료:
     1. **서버 수정** (`confirmScheduleService.js`):
        - 조원/방장 personalTimes 저장 시 transportMode, roomId 추가
        - 이동시간 슬롯에 isTravelTime 플래그 추가

     2. **일정 병합 로직** (`MobileScheduleView.js`):
        - fetchPersonalTimes에서 날짜별 그룹화 후 이동시간+수업시간 병합
        - 연속된 시간, 같은 방 이름 체크
        - 병합된 일정에 hasTravelTime 플래그, travelStartTime, travelEndTime 추가

     3. **UI 추가** (`MobileScheduleView.js` - EventDetailModal):
        - 교통정보 섹션 추가 (hasTravelTime === true일 때만 표시)
        - 교통수단 아이콘 및 텍스트 (🚗 자동차 / 🚇 대중교통 / 🚶 도보)
        - 이동시간 표시
        - "🗺️ 경로 보기" 버튼 → 카카오맵 길찾기 새 창 열기

     4. **CSS 추가** (`MobileScheduleView.css`):
        - modal-transport-section, modal-transport-info 스타일
        - transport-row, transport-icon, transport-text 스타일
        - route-button 스타일 (호버/액티브 효과 포함)

   - 결과:
     - ✅ 이동시간과 수업시간이 하나의 일정으로 병합되어 표시
     - ✅ 장소를 클릭하면 바로 아래에 교통정보 섹션 표시 (장소+교통정보 통합)
     - ✅ 교통수단, 이동시간 자동 표시
     - ✅ "경로 보기" 버튼 클릭 시:
       - 좌표 있음: 카카오맵에 자동으로 출발지→도착지 경로 표시
       - 좌표 없음: 목적지 주소로 검색 + 안내 메시지
     - ✅ 모바일 일정 페이지에서만 병합, 다른 페이지는 기존 방식 유지

   - 파일 수정됨:
     - `server/services/confirmScheduleService.js`
     - `client/src/components/mobile/MobileScheduleView.js`
     - `client/src/components/mobile/MobileScheduleView.css`

   - 카카오맵 URL 형식:
     - 좌표 기반: `https://map.kakao.com/link/to/도착지명,위도,경도/from/출발지명,위도,경도`
     - 주소 기반: `https://map.kakao.com/link/search/주소` (폴백)

### ✅ 완료된 문제들 (2026-01-07 - 5차)

34. **카카오맵 경로 보기 출발지 로직 수정** ✅ 완료
   - 증상: 카카오맵 길찾기 링크 생성 시 출발지가 항상 "내 집"으로 고정되어, 연속된 일정(A→B)의 이동 경로를 확인하기 어려움.
   - 해결:
     - `getPreviousEventLocation` 함수 구현: 현재 일정 바로 직전의 일정을 탐색.
     - `EventDetailModal`에 `previousLocation` prop 전달.
     - 경로 보기 클릭 시:
       - 이전 일정이 있으면: `이전 일정 장소(좌표) → 현재 일정 장소(좌표)`
       - 이전 일정이 없으면: `내 집(좌표) → 현재 일정 장소(좌표)`로 자동 설정.
     - 버튼 텍스트는 심플하게 "🗺️ 경로 보기"로 통일.
   - 파일: `MobileScheduleView.js`

35. **일정 상세 시간 표시 개선 (이동/수업 분리)** ✅ 완료
   - 증상: 이동시간이 포함된 경우 총 시간만 표시되어(예: 9-11시), 실제 이동 시간과 활동 시간을 구분하기 어려움.
   - 해결:
     - `hasTravelTime`이 `true`일 때 시간 표시 형식을 변경하는 `renderTimeSection` 구현.
     - `이동 09:00~10:00 | 수업 10:00~11:00` 형태로 분리하여 시각적으로 명확하게 렌더링.
     - 직관적인 색상 라벨(주황색: 이동, 파란색: 수업) 적용.
   - 파일: `MobileScheduleView.js`, `MobileScheduleView.css`

### 🐛 새로 발견된 문제들 (2026-01-08)

### ✅ 완료된 문제들
38. **방 입장 후에도 목록 헤더(그룹, 생성 버튼)가 사라지지 않는 오류** ✅ 완료
   - 증상: 방에 들어갔음에도 상단에 "그룹", "새 조율방 생성", "조율방 참여" 버튼이 계속 남아있음.
   - 해결: `MobileGroupsView.js`에서 `effectiveIsInRoom` 상태를 도입하여 `isInRoom` 상태와 `localStorage`의 방 ID 존재 여부를 이중 체크하도록 강화하고, 조건부 렌더링 범위를 제목 영역 전체로 확대함.
   - 파일: `MobileGroupsView.js`

39. **채팅봇 버튼 클릭 시 화면이 하얗게 변하는 오류 (White Screen)** ✅ 완료
   - 증상: 플로팅 채팅 버튼을 누르면 화면 전체가 하얗게 변하며 앱이 멈춤.
   - 원인: `CoordinationTab`에서 채팅봇을 감싸고 있던 전체 화면 오버레이(`fixed inset-0 bg-white`)가 렌더링을 방해함.
   - 해결: 
     - 불필요한 오버레이와 강제 열림(`forceOpen`) 코드를 제거.
     - `ChatBox` 컴포넌트를 `Portal`을 사용하여 `document.body`에 렌더링되도록 변경.
     - 버튼 위치를 하단 탭바 위(`bottom: 76px`)로 조정하고 `z-index`를 높여 가려짐 방지.
   - 파일: `CoordinationTab/index.js`, `ChatBox.js`

40. **일정 분류 오류 및 정렬 문제 수정 (PC/모바일)** ✅ 완료
   - 증상: 
     - 오늘 일정이 지난 일정과 오늘 일정에 중복으로 표시됨.
     - 특정 요일(목요일 등) 일정이 예정 일정에서 누락되거나 지난 일정으로 잘못 분류됨.
     - 일정이 시간 순서대로 정렬되지 않음.
   - 원인: `Date` 객체 비교 시 시간(시/분/초)과 타임존 차이로 인해 날짜 경계가 모호해짐.
   - 해결:
     - 날짜 비교 로직을 `YYYY-MM-DD` **문자열 비교**로 변경하여 정확도 향상.
     - `sortByDateTime` 함수를 구현하여 모든 일정을 날짜 및 시간 오름차순으로 정렬.
     - PC(`SchedulingSystem.js`)와 모바일(`MobileScheduleView.js`) 양쪽에 동일하게 적용.
   - 파일: `SchedulingSystem.js`, `MobileScheduleView.js`

## 🚀 Phase 5: 대화형 자동 일정 조율 시스템 상세 계획

### 1. 시스템 핵심 개념
사용자들이 채팅방에서 나누는 자연어 대화를 AI가 실시간으로 분석하여, 일정 관련 합의(시간, 장소, 내용)가 이루어지면 자동으로 일정을 추출하고 등록을 제안하는 지능형 시스템.

### 2. 핵심 개발 모듈
- **A. 방 생성 옵션**: '새 조율방 생성' 시 '대화형 모드' 선택 가능하도록 DB 스키마 및 UI 확장.
- **B. 실시간 그룹 채팅**: Socket.io 기반의 실시간 메시지 전송 및 카카오톡 스타일의 채팅 UI 구현.
- **C. 대화 분석 AI 엔진**: 채팅 로그를 모니터링하여 합의된 일정(날짜, 시간, 목적 등)을 JSON 형태로 추출.
- **D. 일정 피드백 UI**: AI가 감지한 일정을 채팅창에 카드로 띄우고, 사용자가 클릭 한 번으로 확정할 수 있는 인터페이스 제공.

### 3. 단계별 개발 로드맵
1. **1단계 (DB/UI)**: `Room` 모델에 `mode` 필드 추가 및 `RoomCreationModal` UI 수정.
2. **2단계 (Chat)**: 조율방 내부 채팅 탭 구현 및 실시간 소켓 통신 환경 구축.
3. **3단계 (AI Engine)**: 메시지 누적 시 LLM을 호출하여 일정 합의 여부를 판단하는 백엔드 로직 개발.
4. **4단계 (Integration)**: 제안된 일정의 데이터화 및 캘린더 자동 연동 처리.

### ⚠️ 작업 대기 중

(없음)

---
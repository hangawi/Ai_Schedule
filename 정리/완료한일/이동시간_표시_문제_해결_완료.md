# ì´ë™ì‹œê°„ í‘œì‹œ ë¬¸ì œ í•´ê²° ì™„ë£Œ âœ…

**ì‘ì—… ë‚ ì§œ**: 2025-12-12  
**ì‘ì—… ì‹œê°„**: ì•½ 2ì‹œê°„  
**ìƒíƒœ**: âœ… ì™„ë£Œ

---

## ğŸ“‹ ë¬¸ì œ ìš”ì•½

### ì´ˆê¸° ì¦ìƒ
1. **ì´ë™ì‹œê°„ì´ 10ë¶„ìœ¼ë¡œë§Œ í‘œì‹œë¨** (ì‹¤ì œë¡œëŠ” 60ë¶„ì´ì–´ì•¼ í•˜ëŠ”ë°)
2. **ì´ë™ì‹œê°„ ë¸”ë¡ì´ ìˆ˜ì—… ë¸”ë¡ê³¼ ê²¹ì³ì„œ í‘œì‹œë¨**
3. **ìˆ˜ì—… ì‹œê°„ì´ ì´ë™ì‹œê°„ë§Œí¼ ë’¤ë¡œ ë°€ë¦¬ì§€ ì•ŠìŒ**

### ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­
- ë°©ì¥ â†’ í•™ìƒ1 â†’ í•™ìƒ2 ìˆœì„œë¡œ ì´ë™ ê²½ë¡œ ê³„ì‚°
- ì´ë™ì‹œê°„ì´ í•˜ë‚˜ì˜ ë¸”ë¡ì„ ì°¨ì§€í•˜ë„ë¡ í‘œì‹œ
- ìˆ˜ì—… ì‹œê°„ì´ ì´ë™ì‹œê°„ë§Œí¼ ë’¤ë¡œ ë°€ë ¤ì•¼ í•¨
- ê¸°ë³¸ ëª¨ë“œì—ì„œë„ ëŒ€ì¤‘êµí†µ ë³´ê¸°ê°€ ì •ìƒ ì‘ë™í•´ì•¼ í•¨

---

## ğŸ” ê·¼ë³¸ ì›ì¸ ë¶„ì„

### ì›ì¸ 1: TimetableGrid ë³‘í•© ë¡œì§ ë¬¸ì œ
**íŒŒì¼**: `client/src/components/timetable/TimetableGrid.js`

**ë¬¸ì œ**: 
- ì´ë™ì‹œê°„ ëª¨ë“œ(`travelMode !== 'normal'`)ì¼ ë•Œ ë³‘í•©ì„ ê±´ë„ˆë›°ë„ë¡ ë˜ì–´ ìˆìŒ
- 10ë¶„ ë‹¨ìœ„ ìŠ¬ë¡¯ì´ ê°œë³„ë¡œ í‘œì‹œë˜ì–´ ì‹œê°„í‘œê°€ ì§€ì €ë¶„í•˜ê²Œ ë³´ì„

**ì½”ë“œ**:
```javascript
// ë¬¸ì œê°€ ìˆë˜ ì½”ë“œ
useEffect(() => {
  if (travelMode !== 'normal') {
    setMergedTimeSlots(timeSlots);  // ë³‘í•©í•˜ì§€ ì•Šê³  ì›ë³¸ ì‚¬ìš©
    return;
  }
  const merged = mergeConsecutiveTimeSlots(timeSlots);
  setMergedTimeSlots(merged);
}, [timeSlots, showMerged, travelMode]);
```

**í•´ê²°**:
```javascript
// ìˆ˜ì •ëœ ì½”ë“œ
useEffect(() => {
  // ì´ë™ì‹œê°„ ëª¨ë“œì—ì„œë„ ë³‘í•© ìˆ˜í–‰
  const merged = mergeConsecutiveTimeSlots(timeSlots);
  setMergedTimeSlots(merged);
}, [timeSlots, showMerged, travelMode]);
```

---

### ì›ì¸ 2: getCurrentScheduleData í•˜ë“œì½”ë”© ë¬¸ì œ
**íŒŒì¼**: `client/src/hooks/useTravelMode.js`

**ë¬¸ì œ**: 
- `enhancedSchedule`ì´ ê³„ì‚° ì¤‘ì¼ ë•Œ í•˜ë“œì½”ë”©ëœ `'normal'`ì„ ë°˜í™˜
- ì‚¬ìš©ìê°€ "ëŒ€ì¤‘êµí†µ ë³´ê¸°"ë¥¼ ëˆŒë €ëŠ”ë°ë„ `travelMode: 'normal'`ì´ ë°˜í™˜ë¨

**ì½”ë“œ**:
```javascript
// ë¬¸ì œê°€ ìˆë˜ ì½”ë“œ
const getCurrentScheduleData = useCallback(() => {
  if (travelMode === 'normal' || !enhancedSchedule) {
    return {
      timeSlots: currentRoom?.timeSlots || [],
      travelSlots: [],
      travelMode: 'normal'  // âŒ í•­ìƒ 'normal' ë°˜í™˜
    };
  }
  return enhancedSchedule;
}, [travelMode, enhancedSchedule, currentRoom]);
```

**í•´ê²°**:
```javascript
// ìˆ˜ì •ëœ ì½”ë“œ
const getCurrentScheduleData = useCallback(() => {
  if (travelMode === 'normal' || !enhancedSchedule) {
    return {
      timeSlots: currentRoom?.timeSlots || [],
      travelSlots: [],
      travelMode: travelMode  // âœ… ì‹¤ì œ travelMode ë°˜í™˜
    };
  }
  return enhancedSchedule;
}, [travelMode, enhancedSchedule, currentRoom, isCalculating]);
```

---

### ì›ì¸ 3: CoordinationTab props ì „ë‹¬ ë¬¸ì œ
**íŒŒì¼**: `client/src/components/tabs/CoordinationTab/index.js`

**ë¬¸ì œ**: 
- `useTravelMode` í›…ì˜ state ë³€ìˆ˜(`travelMode`)ë¥¼ ì „ë‹¬
- ì´ stateëŠ” `currentRoom` ë³€ê²½ ì‹œ 'normal'ë¡œ ë¦¬ì…‹ë¨
- `scheduleData.travelMode`ì™€ ë‹¤ë¥¸ ê°’ì´ ì „ë‹¬ë¨

**ì½”ë“œ**:
```javascript
// ë¬¸ì œê°€ ìˆë˜ ì½”ë“œ
const { travelMode, getCurrentScheduleData } = useTravelMode(currentRoom);
const scheduleData = getCurrentScheduleData();

<TimetableGrid
  timeSlots={scheduleData.timeSlots}
  travelMode={travelMode}  // âŒ í›…ì˜ state ë³€ìˆ˜ (ë¦¬ì…‹ë  ìˆ˜ ìˆìŒ)
/>
```

**í•´ê²°**:
```javascript
// ìˆ˜ì •ëœ ì½”ë“œ
<TimetableGrid
  timeSlots={scheduleData.timeSlots}
  travelMode={scheduleData.travelMode}  // âœ… ë°ì´í„°ì˜ travelMode
/>
```

---

### ì›ì¸ 4: ì´ì „ í™œë™ ì¢…ë£Œ ì‹œê°„ ë¯¸ì¶”ì 
**íŒŒì¼**: `client/src/services/travelScheduleCalculator.js`

**ë¬¸ì œ**: 
- ì—¬ëŸ¬ í•™ìƒì˜ ìˆ˜ì—…ì´ ê°™ì€ ë‚ ì§œì— ìˆì„ ë•Œ, ë‘ ë²ˆì§¸ í•™ìƒë¶€í„°ëŠ” ì´ì „ í•™ìƒì˜ ì¡°ì •ëœ ì¢…ë£Œ ì‹œê°„ì„ ê³ ë ¤í•˜ì§€ ì•ŠìŒ
- ì˜ˆ: ì´ì´(10:00-11:00) â†’ ì‚¼ì‚¼(10:00-11:00)
  - ì´ì´ê°€ 10:00-11:00ìœ¼ë¡œ ì¡°ì •ë˜ë©´
  - ì‚¼ì‚¼ì€ 11:00 ì´í›„ì— ì‹œì‘í•´ì•¼ í•˜ëŠ”ë°
  - ì›ë³¸ ì‹œì‘ ì‹œê°„(10:00)ì„ ì‚¬ìš©í•´ì„œ ê²¹ì¹¨ ë°œìƒ

**ì‹œë‚˜ë¦¬ì˜¤**:
```
12-08 ì›”ìš”ì¼ ì›ë³¸:
- ì´ì´: 09:00-10:00
- ì‚¼ì‚¼: 10:00-11:00

ì¡°ì • ê³¼ì • (ë¬¸ì œ):
1. ì´ì´: ë°©ì¥â†’ì´ì´ 60ë¶„ ì´ë™
   - ì´ë™: 09:00-10:00
   - ìˆ˜ì—…: 10:00-11:00 âœ…
   
2. ì‚¼ì‚¼: ì´ì´â†’ì‚¼ì‚¼ 10ë¶„ ì´ë™
   - ì´ë™: 10:00-10:10 âŒ (ì´ì´ì™€ ê²¹ì¹¨!)
   - ìˆ˜ì—…: 10:10-11:10 âŒ

ê¸°ëŒ€ ê²°ê³¼:
   - ì´ë™: 11:00-11:10 âœ… (ì´ì´ ì¢…ë£Œ í›„)
   - ìˆ˜ì—…: 11:10-12:10 âœ…
```

**í•´ê²°**:
```javascript
// ë‚ ì§œë³„ ì´ì „ í™œë™ ì¢…ë£Œ ì‹œê°„ ì¶”ì  ë³€ìˆ˜ ì¶”ê°€
let previousActivityEndMinutes = 0;

// ë‚ ì§œ ë³€ê²½ ì‹œ ë¦¬ì…‹
if (slotDate !== currentDate) {
  currentDate = slotDate;
  previousActivityEndMinutes = 0;
  previousLocation = { /* ë°©ì¥ */ };
}

// ì´ë™ì‹œê°„ ì‹œì‘ì€ ì›ë³¸ ì‹œì‘ vs ì´ì „ ì¢…ë£Œ ì¤‘ ëŠ¦ì€ ê²ƒ
let newTravelStartMinutes = Math.max(
  slotStartMinutes,              // ì›ë³¸ ì‹œì‘ ì‹œê°„
  previousActivityEndMinutes     // ì´ì „ í™œë™ ì¢…ë£Œ ì‹œê°„
);

// í™œë™ ì¢…ë£Œ í›„ ì—…ë°ì´íŠ¸
previousActivityEndMinutes = newActivityEndTimeMinutes;
```

---

### ì›ì¸ 5: ì´ë™ì‹œê°„ ì¢…ë£Œ ê³„ì‚° ë²„ê·¸ (ìµœì¢… ë²„ê·¸!)
**íŒŒì¼**: `client/src/services/travelScheduleCalculator.js`

**ë¬¸ì œ**: 
- ì´ë™ì‹œê°„ ì¢…ë£Œë¥¼ **ì›ë³¸ ì‹œì‘ ì‹œê°„** ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°
- ì¡°ì •ëœ ì´ë™ì‹œê°„ ì‹œì‘ê³¼ ë§ì§€ ì•Šì•„ "11:10-10:10" ê°™ì€ ì˜ëª»ëœ ì‹œê°„ ìƒì„±
- `unmergeBlock`ì´ ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œê°„ ë²”ìœ„ë¥¼ ì²˜ë¦¬í•˜ì§€ ëª»í•´ ìŠ¬ë¡¯ì´ ì‚¬ë¼ì§

**ë¡œê·¸ ì˜ˆì‹œ**:
```javascript
{
  ì›ë³¸: '10:00-11:00',
  ì´ë™: '11:10-10:10',  // âŒ ì‹œì‘ > ì¢…ë£Œ!
  ì¡°ì •ëœìˆ˜ì—…: '10:10-11:10',
  ì´ì „ì¢…ë£Œ: '11:10'
}
```

**ê³„ì‚° ê³¼ì • (ë¬¸ì œ)**:
```javascript
let newTravelStartMinutes = Math.max(600, 670) = 670;  // 11:10 âœ…
let newTravelEndTimeMinutes = 600 + 10 = 610;          // 10:10 âŒ (ì›ë³¸ ê¸°ì¤€!)
let newActivityStartTimeMinutes = 610;                 // 10:10 âŒ
let newActivityEndTimeMinutes = 610 + 60 = 670;        // 11:10 âŒ
```

**í•´ê²°**:
```javascript
// ìˆ˜ì • ì „
let newTravelStartMinutes = Math.max(slotStartMinutes, previousActivityEndMinutes);
let newTravelEndTimeMinutes = slotStartMinutes + travelDurationMinutes;  // âŒ

// ìˆ˜ì • í›„
let newTravelStartMinutes = Math.max(slotStartMinutes, previousActivityEndMinutes);
let newTravelEndTimeMinutes = newTravelStartMinutes + travelDurationMinutes;  // âœ…
let newActivityStartTimeMinutes = newTravelEndTimeMinutes;
let newActivityEndTimeMinutes = newActivityStartTimeMinutes + activityDurationMinutes;
```

**ê³„ì‚° ê³¼ì • (ìˆ˜ì • í›„)**:
```javascript
let newTravelStartMinutes = Math.max(600, 670) = 670;   // 11:10 âœ…
let newTravelEndTimeMinutes = 670 + 10 = 680;           // 11:20 âœ… (ì¡°ì •ëœ ì‹œì‘ ê¸°ì¤€!)
let newActivityStartTimeMinutes = 680;                  // 11:20 âœ…
let newActivityEndTimeMinutes = 680 + 60 = 740;         // 12:20 âœ…
```

---

## ğŸ”§ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

1. **client/src/components/timetable/TimetableGrid.js**
   - ì´ë™ì‹œê°„ ëª¨ë“œì—ì„œë„ ë³‘í•© ìˆ˜í–‰í•˜ë„ë¡ ìˆ˜ì •

2. **client/src/hooks/useTravelMode.js**
   - `getCurrentScheduleData`ì—ì„œ ì‹¤ì œ `travelMode` ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •

3. **client/src/components/tabs/CoordinationTab/index.js**
   - `TimetableGrid`ì— `scheduleData.travelMode` ì „ë‹¬í•˜ë„ë¡ ìˆ˜ì •

4. **client/src/services/travelScheduleCalculator.js**
   - ì´ì „ í™œë™ ì¢…ë£Œ ì‹œê°„ ì¶”ì  ë¡œì§ ì¶”ê°€
   - ì´ë™ì‹œê°„ ì¢…ë£Œ ê³„ì‚°ì„ ì¡°ì •ëœ ì‹œì‘ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜ì •

---

## âœ… ìµœì¢… ê²°ê³¼

### 12-08 ì›”ìš”ì¼ ì˜ˆì‹œ

**ì›ë³¸ ë°°ì •:**
- ì´ì´: 09:00-10:00
- ì‚¼ì‚¼: 10:00-11:00

**ì¡°ì • í›„ (ì´ë™ì‹œê°„ í¬í•¨):**
- **ì´ë™ì‹œê°„ (ë°©ì¥â†’ì´ì´)**: 09:00-10:00 (60ë¶„)
- **ì´ì´ ìˆ˜ì—…**: 10:00-11:00
- **ì´ë™ì‹œê°„ (ì´ì´â†’ì‚¼ì‚¼)**: 11:00-11:10 (10ë¶„)
- **ì‚¼ì‚¼ ìˆ˜ì—…**: 11:10-12:10

### í™”ë©´ í‘œì‹œ
- ê° ë¸”ë¡ì´ ê²¹ì¹˜ì§€ ì•Šê³  ìˆœì„œëŒ€ë¡œ í‘œì‹œë¨
- ì´ë™ì‹œê°„ì´ ì ì„  í…Œë‘ë¦¬ë¡œ êµ¬ë¶„ë˜ì–´ í‘œì‹œë¨
- ë³‘í•© ëª¨ë“œì—ì„œ 10ë¶„ ìŠ¬ë¡¯ë“¤ì´ í•˜ë‚˜ì˜ ë¸”ë¡ìœ¼ë¡œ ë³‘í•©ë¨
- ëŒ€ì¤‘êµí†µ/ìë™ì°¨/ìì „ê±°/ë„ë³´ ëª¨ë“œ ëª¨ë‘ ì •ìƒ ì‘ë™

---

## ğŸ“ êµí›ˆ

1. **State vs Data êµ¬ë¶„**: 
   - í›…ì˜ state ë³€ìˆ˜ì™€ ë°ì´í„° ê°ì²´ì˜ í•„ë“œë¥¼ ëª…í™•íˆ êµ¬ë¶„
   - ë¦¬ì…‹ë  ìˆ˜ ìˆëŠ” stateë¥¼ propsë¡œ ì „ë‹¬í•˜ì§€ ë§ ê²ƒ

2. **ì‹œê°„ ê³„ì‚°ì€ í•­ìƒ ì¡°ì •ëœ ê°’ ê¸°ì¤€**:
   - ì›ë³¸ ê°’ì„ ì°¸ì¡°í•˜ë©´ ì•ˆ ë¨
   - ì´ì „ ë‹¨ê³„ì˜ ê²°ê³¼ë¥¼ ë‹¤ìŒ ë‹¨ê³„ì˜ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©

3. **ì—°ì‡„ ì‘ì—…ì—ì„œ ì´ì „ ìƒíƒœ ì¶”ì **:
   - ì—¬ëŸ¬ í•­ëª©ì„ ìˆœì°¨ ì²˜ë¦¬í•  ë•Œ ì´ì „ í•­ëª©ì˜ ê²°ê³¼ë¥¼ ì¶”ì í•´ì•¼ í•¨
   - ë‚ ì§œ/ì»¨í…ìŠ¤íŠ¸ ë³€ê²½ ì‹œ ìƒíƒœ ë¦¬ì…‹ í•„ìˆ˜

4. **ë””ë²„ê¹…ì€ ë¡œê·¸ê°€ ìƒëª…**:
   - ê° ë‹¨ê³„ì˜ ì…ë ¥/ì¶œë ¥ì„ ìƒì„¸íˆ ë¡œê¹…
   - ì¤‘ê°„ ê³„ì‚° ê°’ë„ ëª¨ë‘ ë¡œê¹…í•˜ì—¬ ë¬¸ì œ ì§€ì  íŒŒì•…

5. **ì ì§„ì  ìˆ˜ì •ê³¼ í…ŒìŠ¤íŠ¸**:
   - í•œ ë²ˆì— ëª¨ë“  ê²ƒì„ ê³ ì¹˜ë ¤ í•˜ì§€ ë§ê³ 
   - í•˜ë‚˜ì”© ìˆ˜ì •í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ë©° ì§„í–‰

---

## ğŸ¯ í…ŒìŠ¤íŠ¸ ì™„ë£Œ í•­ëª©

- âœ… ê¸°ë³¸ ëª¨ë“œ + ëŒ€ì¤‘êµí†µ ë³´ê¸°
- âœ… ì—¬ëŸ¬ ë‚ ì§œì— ê±¸ì¹œ ë°°ì •
- âœ… ê°™ì€ ë‚ ì§œì— ì—¬ëŸ¬ í•™ìƒ ë°°ì •
- âœ… ë°©ì¥â†’í•™ìƒ1â†’í•™ìƒ2 ìˆœì„œ ì´ë™
- âœ… ë³‘í•© ëª¨ë“œì—ì„œ ë¸”ë¡ í‘œì‹œ
- âœ… ì´ë™ì‹œê°„ê³¼ ìˆ˜ì—… ë¸”ë¡ êµ¬ë¶„

---

**ì‘ì—…ì**: Claude Sonnet 4.5  
**ì™„ë£Œ ì¼ì‹œ**: 2025-12-12
